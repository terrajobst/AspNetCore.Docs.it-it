---
uid: web-forms/overview/older-versions-security/roles/creating-and-managing-roles-vb
title: Creazione e gestione dei ruoli (VB) | Documenti Microsoft
author: rick-anderson
description: "In questa esercitazione vengono esaminati i passaggi necessari per configurare il framework di ruoli. Successivamente, verrà compilata pagine web per creare ed eliminare ruoli."
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/24/2008
ms.topic: article
ms.assetid: 83af9f5f-9a00-4f83-8afc-e98bdd49014e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/roles/creating-and-managing-roles-vb
msc.type: authoredcontent
ms.openlocfilehash: 0b1132c6d782cd85edb8cbee98c8ab95a15171ac
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/24/2018
---
<a name="creating-and-managing-roles-vb"></a><span data-ttu-id="5d3e2-104">Creazione e gestione dei ruoli (VB)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-104">Creating and Managing Roles (VB)</span></span>
====================
<span data-ttu-id="5d3e2-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5d3e2-106">[Scaricare codice](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.09.zip) o [Scarica il PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.09.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial09_CreatingRoles_vb.pdf)</span></span>

> <span data-ttu-id="5d3e2-107">In questa esercitazione vengono esaminati i passaggi necessari per configurare il framework di ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-107">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="5d3e2-108">Successivamente, verrà compilata pagine web per creare ed eliminare ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-108">Following that, we will build web pages to create and delete roles.</span></span>


## <a name="introduction"></a><span data-ttu-id="5d3e2-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="5d3e2-109">Introduction</span></span>

<span data-ttu-id="5d3e2-110">Nel <a id="_msoanchor_1"> </a> [ *autorizzazione basata sull'utente* ](../membership/user-based-authorization-vb.md) esercitazione viene descritto l'utilizzo di autorizzazione URL per impedire un set di pagine di determinati utenti ed esplorato dichiarativa e tecniche a livello di codice per la regolazione delle funzionalità della pagina ASP.NET in base all'utente di accesso.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-110">In the <a id="_msoanchor_1"></a>[*User-Based Authorization*](../membership/user-based-authorization-vb.md) tutorial we looked at using URL authorization to restrict certain users from a set of pages and explored declarative and programmatic techniques for adjusting an ASP.NET page's functionality based on the visiting user.</span></span> <span data-ttu-id="5d3e2-111">Concessione dell'autorizzazione per l'accesso alla pagina o la funzionalità su base utente dall'utente, tuttavia, può diventare un incubo negli scenari in cui sono presenti più account utente o quando vengono modificati spesso privilegi degli utenti.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-111">Granting permission for page access or functionality on a user-by-user basis, however, can become a maintenance nightmare in scenarios where there are many user accounts or when users' privileges change often.</span></span> <span data-ttu-id="5d3e2-112">Ogni volta che un utente acquisisce o perde l'autorizzazione per eseguire una determinata attività, l'amministratore deve aggiornare le regole di autorizzazione URL appropriate, markup dichiarativo e codice.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-112">Any time a user gains or loses authorization to perform a particular task, the administrator needs to update the appropriate URL authorization rules, declarative markup, and code.</span></span>

<span data-ttu-id="5d3e2-113">In genere consente di classificare gli utenti in gruppi o *ruoli* e quindi applicare le autorizzazioni in base al ruolo per ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-113">It usually helps to classify users into groups or *roles* and then to apply permissions on a role-by-role basis.</span></span> <span data-ttu-id="5d3e2-114">Ad esempio, la maggior parte delle applicazioni web dispongono di un determinato set di pagine o attività che sono riservate solo per gli utenti amministratori.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-114">For example, most web applications have a certain set of pages or tasks that are reserved only for administrative users.</span></span> <span data-ttu-id="5d3e2-115">Utilizzando le tecniche descritte nel *autorizzazione basata sull'utente* esercitazione, verrà aggiunto codice per consentire gli account utente specificato eseguire attività amministrative, regole di autorizzazione URL appropriate e markup dichiarativo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-115">Using the techniques learned in the *User-Based Authorization* tutorial, we would add the appropriate URL authorization rules, declarative markup, and code to allow the specified user accounts to perform administrative tasks.</span></span> <span data-ttu-id="5d3e2-116">Ma se è stato aggiunto un nuovo amministratore o un amministratore esistente è necessario disporre di diritti di amministrazione del proprio revocati, è necessario restituire e aggiornare il file di configurazione e le pagine web.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-116">But if a new administrator was added or if an existing administrator needed to have her administration rights revoked, we would have to return and update the configuration files and web pages.</span></span> <span data-ttu-id="5d3e2-117">Con i ruoli, tuttavia, è possibile creare un ruolo di amministratori e assegnare gli utenti attendibili per il ruolo di amministratore.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-117">With roles, however, we could create a role called Administrators and assign those trusted users to the Administrators role.</span></span> <span data-ttu-id="5d3e2-118">Successivamente, verrà aggiunto codice per consentire al ruolo di amministratori per eseguire le varie attività amministrative, regole di autorizzazione URL appropriate e markup dichiarativo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-118">Next, we would add the appropriate URL authorization rules, declarative markup, and code to allow the Administrators role to perform the various administrative tasks.</span></span> <span data-ttu-id="5d3e2-119">Con questa infrastruttura, è semplice come includendo o la rimozione dell'utente dal ruolo degli amministratori di aggiungere nuovi amministratori al sito o la rimozione di quelli esistenti.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-119">With this infrastructure in place, adding new administrators to the site or removing existing ones is as simple as including or removing the user from the Administrators role.</span></span> <span data-ttu-id="5d3e2-120">Nessuna configurazione, markup dichiarativo o modifiche al codice sono necessari.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-120">No configuration, declarative markup, or code changes are necessary.</span></span>

<span data-ttu-id="5d3e2-121">ASP.NET offre un framework di ruoli per definire i ruoli e associarli agli account utente.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-121">ASP.NET offers a Roles framework for defining roles and associating them with user accounts.</span></span> <span data-ttu-id="5d3e2-122">Con il framework di ruoli, è possibile creare ed eliminare ruoli, aggiungere o rimuovere utenti da un ruolo, determinare il set di utenti che appartengono a un ruolo specifico e indicare se un utente appartiene a un ruolo specifico.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-122">With the Roles framework we can create and delete roles, add users to or remove users from a role, determine the set of users that belong to a particular role, and tell whether a user belongs to a particular role.</span></span> <span data-ttu-id="5d3e2-123">Una volta configurato il framework di ruoli, è possibile limitare l'accesso alle pagine in base ruolo per ruolo tramite regole di autorizzazione URL e mostrare o nascondere informazioni aggiuntive o funzionalità in una pagina in base ai ruoli dell'utente attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-123">Once the Roles framework has been configured, we can limit access to pages on a role-by-role basis through URL authorization rules and show or hide additional information or functionality on a page based on the currently logged on user's roles.</span></span>

<span data-ttu-id="5d3e2-124">In questa esercitazione vengono esaminati i passaggi necessari per configurare il framework di ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-124">This tutorial examines the steps necessary for configuring the Roles framework.</span></span> <span data-ttu-id="5d3e2-125">Successivamente, verrà compilata pagine web per creare ed eliminare ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-125">Following that, we will build web pages to create and delete roles.</span></span> <span data-ttu-id="5d3e2-126">Nel <a id="_msoanchor_2"> </a> [ *l'assegnazione di ruoli agli utenti* ](assigning-roles-to-users-vb.md) esercitazione verranno esaminati come aggiungere e rimuovere utenti dai ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-126">In the <a id="_msoanchor_2"></a>[*Assigning Roles to Users*](assigning-roles-to-users-vb.md) tutorial we will look at how to add and remove users from roles.</span></span> <span data-ttu-id="5d3e2-127">E il <a id="_msoanchor_3"> </a> [ *autorizzazione basata sui ruoli* ](role-based-authorization-vb.md) esercitazione verrà spiegato come limitare l'accesso alle pagine con cadenza ruolo per ruolo insieme come regolare a seconda delle funzionalità pagina ruolo dell'utente.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-127">And in the <a id="_msoanchor_3"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial we will see how to limit access to pages on a role-by-role basis along with how to adjust page functionality depending on the visiting user's role.</span></span> <span data-ttu-id="5d3e2-128">Iniziamo!</span><span class="sxs-lookup"><span data-stu-id="5d3e2-128">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="5d3e2-129">Passaggio 1: Aggiunta di nuove pagine ASP.NET</span><span class="sxs-lookup"><span data-stu-id="5d3e2-129">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="5d3e2-130">In questa esercitazione e i due successivi è verrà esaminando le funzioni correlate a ruoli e le funzionalità.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-130">In this tutorial and the next two we will be examining various roles-related functions and capabilities.</span></span> <span data-ttu-id="5d3e2-131">È necessario una serie di pagine ASP.NET per implementare gli argomenti esaminati in queste esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-131">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="5d3e2-132">Di seguito creare queste pagine e aggiornare la mappa del sito.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-132">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="5d3e2-133">Iniziare creando una nuova cartella nel progetto denominato `Roles`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-133">Start by creating a new folder in the project named `Roles`.</span></span> <span data-ttu-id="5d3e2-134">Successivamente, aggiungere quattro nuove pagine ASP.NET per il `Roles` cartella, il collegamento di ogni pagina con il `Site.master` pagina master.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-134">Next, add four new ASP.NET pages to the `Roles` folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="5d3e2-135">Le pagine dei nomi:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-135">Name the pages:</span></span>

- `ManageRoles.aspx`
- `UsersAndRoles.aspx`
- `CreateUserWizardWithRoles.aspx`
- `RoleBasedAuthorization.aspx`

<span data-ttu-id="5d3e2-136">Esplora soluzioni del progetto a questo punto dovrebbe essere simile alla schermata illustrata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-136">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


<span data-ttu-id="5d3e2-137">[![Sono stati aggiunti quattro nuove pagine nella cartella dei ruoli](creating-and-managing-roles-vb/_static/image2.png)](creating-and-managing-roles-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-137">[![Four New Pages Have Been Added to the Roles Folder](creating-and-managing-roles-vb/_static/image2.png)](creating-and-managing-roles-vb/_static/image1.png)</span></span>

<span data-ttu-id="5d3e2-138">**Figura 1**: quattro nuove pagine sono stati aggiunti i `Roles` cartella ([fare clic per visualizzare l'immagine ingrandita](creating-and-managing-roles-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5d3e2-138">**Figure 1**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image3.png))</span></span>


<span data-ttu-id="5d3e2-139">Ogni pagina, dovrebbe rispondere a questo punto, includere i due controlli contenuti, uno per ognuno dei ContentPlaceHolder della pagina master: `MainContent` e `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-139">Each page should, at this point, have the two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample1.aspx)]

<span data-ttu-id="5d3e2-140">Tenere presente che il `LoginContent` markup predefinito del ContentPlaceHolder viene visualizzato un collegamento per connettersi o disconnettersi del sito, a seconda che l'utente è autenticato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-140">Recall that the `LoginContent` ContentPlaceHolder's default markup displays a link to log on or log off the site, depending on whether the user is authenticated.</span></span> <span data-ttu-id="5d3e2-141">La presenza del `Content2` contenuto controllo nella pagina ASP.NET, tuttavia, esegue l'override di markup predefinito della pagina master.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-141">The presence of the `Content2` Content control in the ASP.NET page, however, overrides the master page's default markup.</span></span> <span data-ttu-id="5d3e2-142">Come accennato <a id="_msoanchor_4"> </a> [ *una panoramica dell'autenticazione basata su form* ](../introduction/an-overview-of-forms-authentication-vb.md) esercitazione, si esegue l'override il markup predefinito è utile nelle pagine in cui si preferisce non visualizzare relative all'accesso opzioni nella colonna sinistra.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-142">As we discussed in <a id="_msoanchor_4"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, overriding the default markup is useful in pages where we do not want to display login-related options in the left column.</span></span>

<span data-ttu-id="5d3e2-143">Per questi quattro pagine, tuttavia, si desidera mostrare il markup della pagina master predefinita per il `LoginContent` ContentPlaceHolder.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-143">For these four pages, however, we want to show the master page's default markup for the `LoginContent` ContentPlaceHolder.</span></span> <span data-ttu-id="5d3e2-144">Pertanto, rimuovere il markup dichiarativo per la `Content2` controllo contenuto.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-144">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="5d3e2-145">Al termine dell'operazione, ognuno dei markup della pagina quattro deve contenere solo un controllo contenuto.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-145">After doing so, each of the four page's markup should contain just one Content control.</span></span>

<span data-ttu-id="5d3e2-146">Infine, si aggiorna la mappa del sito (`Web.sitemap`) per includere le nuove pagine web.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-146">Finally, let's update the site map (`Web.sitemap`) to include these new web pages.</span></span> <span data-ttu-id="5d3e2-147">Aggiungere il seguente codice XML dopo la `<siteMapNode>` abbiamo aggiunto per le esercitazioni di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-147">Add the following XML after the `<siteMapNode>` we added for the Membership tutorials.</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample2.xml)]

<span data-ttu-id="5d3e2-148">Con la mappa del sito è stata aggiornata, visitare il sito tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-148">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="5d3e2-149">Come illustrato nella figura 2, la navigazione a sinistra ora include gli elementi per le esercitazioni di ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-149">As Figure 2 shows, the navigation on the left now includes items for the Roles tutorials.</span></span>


<span data-ttu-id="5d3e2-150">[![Sono stati aggiunti quattro nuove pagine nella cartella dei ruoli](creating-and-managing-roles-vb/_static/image5.png)](creating-and-managing-roles-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-150">[![Four New Pages Have Been Added to the Roles Folder](creating-and-managing-roles-vb/_static/image5.png)](creating-and-managing-roles-vb/_static/image4.png)</span></span>

<span data-ttu-id="5d3e2-151">**Figura 2**: quattro nuove pagine sono stati aggiunti i `Roles` cartella ([fare clic per visualizzare l'immagine ingrandita](creating-and-managing-roles-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="5d3e2-151">**Figure 2**: Four New Pages Have Been Added to the `Roles` Folder  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image6.png))</span></span>


## <a name="step-2-specifying-and-configuring-the-roles-framework-provider"></a><span data-ttu-id="5d3e2-152">Passaggio 2: Impostazione e sulla configurazione del Provider di ruoli Framework</span><span class="sxs-lookup"><span data-stu-id="5d3e2-152">Step 2: Specifying and Configuring the Roles Framework Provider</span></span>

<span data-ttu-id="5d3e2-153">Ad esempio il framework di appartenenza, il framework di ruoli viene compilato nella parte superiore del modello di provider.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-153">Like the Membership framework, the Roles framework is built atop the provider model.</span></span> <span data-ttu-id="5d3e2-154">Come descritto nel <a id="_msoanchor_5"> </a> [ *nozioni fondamentali sulla sicurezza e il supporto ASP.NET* ](../introduction/security-basics-and-asp-net-support-vb.md) esercitazione, .NET Framework include tre provider di ruoli predefiniti: [ `AuthorizationStoreRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx) , [ `WindowsTokenRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), e [ `SqlRoleProvider` ](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-154">As discussed in the <a id="_msoanchor_5"></a>[*Security Basics and ASP.NET Support*](../introduction/security-basics-and-asp-net-support-vb.md) tutorial, the .NET Framework ships with three built-in Roles providers: [`AuthorizationStoreRoleProvider`](https://msdn.microsoft.com/library/system.web.security.authorizationstoreroleprovider.aspx), [`WindowsTokenRoleProvider`](https://msdn.microsoft.com/library/system.web.security.windowstokenroleprovider.aspx), and [`SqlRoleProvider`](https://msdn.microsoft.com/library/system.web.security.sqlroleprovider.aspx).</span></span> <span data-ttu-id="5d3e2-155">Questa serie di esercitazioni si concentra sul `SqlRoleProvider`, che utilizza un database di Microsoft SQL Server come archivio ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-155">This tutorial series focuses on the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span>

<span data-ttu-id="5d3e2-156">Nel sistema il framework di ruoli e `SqlRoleProvider` funzionano esattamente come il framework di appartenenza e `SqlMembershipProvider`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-156">Underneath the covers the Roles framework and `SqlRoleProvider` work just like the Membership framework and `SqlMembershipProvider`.</span></span> <span data-ttu-id="5d3e2-157">.NET Framework contiene un `Roles` classe utilizzata come l'API del Framework di ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-157">The .NET Framework contains a `Roles` class that serves as the API to the Roles framework.</span></span> <span data-ttu-id="5d3e2-158">Il `Roles` classe ha condiviso metodi, ad esempio `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`e così via.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-158">The `Roles` class has shared methods like `CreateRole`, `DeleteRole`, `GetAllRoles`, `AddUserToRole`, `IsUserInRole`, and so forth.</span></span> <span data-ttu-id="5d3e2-159">Quando uno di questi metodi viene richiamato, il `Roles` classe delega la chiamata al provider configurato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-159">When one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="5d3e2-160">Il `SqlRoleProvider` funziona con le tabelle specifiche del ruolo (`aspnet_Roles` e `aspnet_UsersInRoles`) nella risposta.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-160">The `SqlRoleProvider` works with the role-specific tables (`aspnet_Roles` and `aspnet_UsersInRoles`) in response.</span></span>

<span data-ttu-id="5d3e2-161">Per utilizzare il `SqlRoleProvider` provider nell'applicazione, è necessario specificare quali database utilizzare come archivio.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-161">In order to use the `SqlRoleProvider` provider in our application, we need to specify what database to use as the store.</span></span> <span data-ttu-id="5d3e2-162">Il `SqlRoleProvider` prevede l'archivio di ruolo specificato per alcune tabelle di database, viste e stored procedure.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-162">The `SqlRoleProvider` expects the specified role store to have certain database tables, views, and stored procedures.</span></span> <span data-ttu-id="5d3e2-163">Questi oggetti di database necessari possono essere aggiunti mediante la [ `aspnet_regsql.exe` strumento](https://msdn.microsoft.com/library/ms229862.aspx).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-163">These requisite database objects can be added using the [`aspnet_regsql.exe` tool](https://msdn.microsoft.com/library/ms229862.aspx).</span></span> <span data-ttu-id="5d3e2-164">A questo punto si dispone già di un database con lo schema necessario per il `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-164">At this point we already have a database with the schema necessary for the `SqlRoleProvider`.</span></span> <span data-ttu-id="5d3e2-165">Nel <a id="_msoanchor_6"> </a> [ *creazione dello Schema di appartenenza in SQL Server* ](../membership/creating-the-membership-schema-in-sql-server-vb.md) esercitazione è stato creato un database denominato `SecurityTutorials.mdf` e utilizzato `aspnet_regsql.exe` per aggiungere l'applicazione servizi, inclusi gli oggetti di database necessari per il `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-165">Back in the <a id="_msoanchor_6"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-vb.md) tutorial we created a database named `SecurityTutorials.mdf` and used `aspnet_regsql.exe` to add the application services, which included the database objects required by the `SqlRoleProvider`.</span></span> <span data-ttu-id="5d3e2-166">Pertanto è necessario indicare al framework di ruoli per abilitare il supporto del ruolo e utilizzare il `SqlRoleProvider` con il `SecurityTutorials.mdf` database come archivio di ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-166">Therefore we just need to tell the Roles framework to enable role support and to use the `SqlRoleProvider` with the `SecurityTutorials.mdf` database as the role store.</span></span>

<span data-ttu-id="5d3e2-167">Il framework di ruoli viene configurato tramite il `<roleManager>` elemento dell'applicazione `Web.config` file.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-167">The Roles framework is configured via the `<roleManager>` element in the application's `Web.config` file.</span></span> <span data-ttu-id="5d3e2-168">Per impostazione predefinita, il supporto di ruolo è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-168">By default, role support is disabled.</span></span> <span data-ttu-id="5d3e2-169">Per abilitarlo, è necessario impostare il [ `<roleManager>` ](https://msdn.microsoft.com/library/ms164660.aspx) dell'elemento `enabled` attributo `true` come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-169">To enable it, you must set the [`<roleManager>`](https://msdn.microsoft.com/library/ms164660.aspx) element's `enabled` attribute to `true` like so:</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample3.xml)]

<span data-ttu-id="5d3e2-170">Per impostazione predefinita, tutte le applicazioni web dispongono di un provider di ruoli denominato `AspNetSqlRoleProvider` di tipo `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-170">By default, all web applications have a Roles provider named `AspNetSqlRoleProvider` of type `SqlRoleProvider`.</span></span> <span data-ttu-id="5d3e2-171">Il provider predefinito è registrato `machine.config` (disponibile all'indirizzo `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span><span class="sxs-lookup"><span data-stu-id="5d3e2-171">This default provider is registered in `machine.config` (located at `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample4.xml)]

<span data-ttu-id="5d3e2-172">Il provider `connectionStringName` attributo specifica l'archivio di ruolo che viene utilizzato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-172">The provider's `connectionStringName` attribute specifies the role store that is used.</span></span> <span data-ttu-id="5d3e2-173">Il `AspNetSqlRoleProvider` provider imposta questo attributo su `LocalSqlServer`, anch ' esso definito `machine.config` punti e, per impostazione predefinita, a un database di SQL Server 2005 Express Edition nel `App_Data` cartella denominata `aspnet.mdf`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-173">The `AspNetSqlRoleProvider` provider sets this attribute to `LocalSqlServer`, which is also defined in `machine.config` and points, by default, to a SQL Server 2005 Express Edition database in the `App_Data` folder named `aspnet.mdf`.</span></span>

<span data-ttu-id="5d3e2-174">Di conseguenza, se si abilita semplicemente il framework di ruoli senza specificare le informazioni del provider dell'applicazione `Web.config` file, l'applicazione utilizza il provider di ruoli predefinito registrato, `AspNetSqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-174">Consequently, if we simply enable the Roles framework without specifying any provider information in our application's `Web.config` file, the application uses the default registered Roles provider, `AspNetSqlRoleProvider`.</span></span> <span data-ttu-id="5d3e2-175">Se il `~/App_Data/aspnet.mdf` database non esiste, il runtime di ASP.NET verrà automaticamente creato e aggiungere lo schema di servizi di applicazione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-175">If the `~/App_Data/aspnet.mdf` database does not exist, the ASP.NET runtime will automatically create it and add the application services schema.</span></span> <span data-ttu-id="5d3e2-176">Tuttavia, non si desidera utilizzare il `aspnet.mdf` database; invece, si desidera utilizzare il `SecurityTutorials.mdf` database che abbiamo già creato e aggiunto lo schema di servizi delle applicazioni per.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-176">However, we don't want to use the `aspnet.mdf` database; rather, we want to use the `SecurityTutorials.mdf` database that we have already created and added the application services schema to.</span></span> <span data-ttu-id="5d3e2-177">Questa modifica può essere eseguita in uno dei due modi:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-177">This modification can be accomplished in one of two ways:</span></span>

- <span data-ttu-id="5d3e2-178">**Specificare un valore per il * * *`LocalSqlServer`* * * il nome di stringa di connessione in * * *`Web.config`* * *.**</span><span class="sxs-lookup"><span data-stu-id="5d3e2-178">**Specify a value for the****`LocalSqlServer`****connection string name in****`Web.config`****.**</span></span> <span data-ttu-id="5d3e2-179">Sovrascrivendo il `LocalSqlServer` valore di nome di stringa di connessione in `Web.config`, è possibile utilizzare il provider di ruoli predefinito registrato (`AspNetSqlRoleProvider`) e fare in modo funzionare correttamente con il `SecurityTutorials.mdf` database.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-179">By overwriting the `LocalSqlServer` connection string name value in `Web.config`, we can use the default registered Roles provider (`AspNetSqlRoleProvider`) and have it correctly work with the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="5d3e2-180">Per ulteriori informazioni su questa tecnica, vedere [Scott Guthrie](https://weblogs.asp.net/scottgu/)del post di blog, [la configurazione di servizi applicativi di ASP.NET 2.0 per utilizzare SQL Server 2000 o SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-180">For more information on this technique, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span></span>
- <span data-ttu-id="5d3e2-181">**Aggiungere un nuovo provider registrati di tipo * * *`SqlRoleProvider`* * * e configurare il * * *`connectionStringName`* * * impostazione in modo che punti al * * *`SecurityTutorials.mdf`* * * database.**</span><span class="sxs-lookup"><span data-stu-id="5d3e2-181">**Add a new registered provider of type****`SqlRoleProvider`****and configure its****`connectionStringName`****setting to point to the****`SecurityTutorials.mdf`****database.**</span></span> <span data-ttu-id="5d3e2-182">Si tratta dell'approccio è consigliato e utilizzata per la <a id="_msoanchor_7"> </a> [ *creazione dello Schema di appartenenza in SQL Server* ](../membership/creating-the-membership-schema-in-sql-server-vb.md) esercitazione ed è l'approccio verrà utilizzato in questa esercitazione anche.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-182">This is the approach I recommended and used in the <a id="_msoanchor_7"></a>[*Creating the Membership Schema in SQL Server*](../membership/creating-the-membership-schema-in-sql-server-vb.md) tutorial, and it is the approach I will use in this tutorial as well.</span></span>

<span data-ttu-id="5d3e2-183">Aggiungere il seguente markup per la configurazione dei ruoli per il `Web.config` file.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-183">Add the following Roles configuration markup to the `Web.config` file.</span></span> <span data-ttu-id="5d3e2-184">In questo markup registra un nuovo provider denominato`SecurityTutorialsSqlRoleProvider.`</span><span class="sxs-lookup"><span data-stu-id="5d3e2-184">This markup registers a new provider named `SecurityTutorialsSqlRoleProvider.`</span></span>

[!code-xml[Main](creating-and-managing-roles-vb/samples/sample5.xml)]

<span data-ttu-id="5d3e2-185">Definisce il codice precedente il `SecurityTutorialsSqlRoleProvider` come provider predefinito (tramite il `defaultProvider` attributo il `<roleManager>` elemento).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-185">The above markup defines the `SecurityTutorialsSqlRoleProvider` as the default provider (via the `defaultProvider` attribute in the `<roleManager>` element).</span></span> <span data-ttu-id="5d3e2-186">Imposta inoltre il `SecurityTutorialsSqlRoleProvider`del `applicationName` impostando su `SecurityTutorials`, ovvero lo stesso `applicationName` impostazione utilizzata dal provider di appartenenze (`SecurityTutorialsSqlMembershipProvider`).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-186">It also sets the `SecurityTutorialsSqlRoleProvider`'s `applicationName` setting to `SecurityTutorials`, which is the same `applicationName` setting used by the Membership provider (`SecurityTutorialsSqlMembershipProvider`).</span></span> <span data-ttu-id="5d3e2-187">Mentre non riportati di seguito, il [ `<add>` elemento](https://msdn.microsoft.com/library/ms164662.aspx) per il `SqlRoleProvider` può inoltre contenere un `commandTimeout` attributo per specificare la durata del timeout del database, in secondi.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-187">While not shown here, the [`<add>` element](https://msdn.microsoft.com/library/ms164662.aspx) for the `SqlRoleProvider` may also contain a `commandTimeout` attribute to specify the database timeout duration, in seconds.</span></span> <span data-ttu-id="5d3e2-188">Il valore predefinito è 30.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-188">The default value is 30.</span></span>

<span data-ttu-id="5d3e2-189">Con questo codice di configurazione sul posto, ci sono pronti per iniziare a usare la funzionalità di ruolo all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-189">With this configuration markup in place, we are ready to start using role functionality within our application.</span></span>

> [!NOTE]
> <span data-ttu-id="5d3e2-190">Il tag di configurazione precedente viene illustrato l'utilizzo di `<roleManager>` dell'elemento `enabled` e `defaultProvider` gli attributi.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-190">The above configuration markup illustrates using the `<roleManager>` element's `enabled` and `defaultProvider` attributes.</span></span> <span data-ttu-id="5d3e2-191">Esistono numerosi altri attributi che influiscono sul modo in cui il framework di ruoli associa le informazioni sui ruoli su base utente dall'utente.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-191">There are a number of other attributes that affect how the Roles framework associates role information on a user-by-user basis.</span></span> <span data-ttu-id="5d3e2-192">Verranno esaminate queste impostazioni nella finestra di <a id="_msoanchor_8"> </a> [ *autorizzazione basata sui ruoli* ](role-based-authorization-vb.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-192">We will examine these settings in the <a id="_msoanchor_8"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial.</span></span>


## <a name="step-3-examining-the-roles-api"></a><span data-ttu-id="5d3e2-193">Passaggio 3: Esaminare i ruoli API</span><span class="sxs-lookup"><span data-stu-id="5d3e2-193">Step 3: Examining the Roles API</span></span>

<span data-ttu-id="5d3e2-194">Funzionalità del framework ruoli viene esposta tramite il [ `Roles` classe](https://msdn.microsoft.com/library/system.web.security.roles.aspx), contenente metodi condivisi tredici per l'esecuzione di operazioni basato sui ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-194">The Roles framework's functionality is exposed via the [`Roles` class](https://msdn.microsoft.com/library/system.web.security.roles.aspx), which contains thirteen shared methods for performing role-based operations.</span></span> <span data-ttu-id="5d3e2-195">Quando si esamina creazione ed eliminazione di ruoli in passaggi 4 e 6 verrà usata la [ `CreateRole` ](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) e [ `DeleteRole` ](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) i metodi, aggiungere o rimuovere un ruolo dal sistema.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-195">When we look at creating and deleting roles in Steps 4 and 6 we will use the [`CreateRole`](https://msdn.microsoft.com/library/system.web.security.roles.createrole.aspx) and [`DeleteRole`](https://msdn.microsoft.com/library/system.web.security.roles.deleterole.aspx) methods, which add or remove a role from the system.</span></span>

<span data-ttu-id="5d3e2-196">Per ottenere un elenco di tutti i ruoli del sistema, utilizzare il [ `GetAllRoles` metodo](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (vedere il passaggio 5).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-196">To get a list of all of the roles in the system, use the [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx) (see Step 5).</span></span> <span data-ttu-id="5d3e2-197">Il [ `RoleExists` metodo](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) restituisce un valore booleano che indica se un ruolo specificato esiste.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-197">The [`RoleExists` method](https://msdn.microsoft.com/library/system.web.security.roles.roleexists.aspx) returns a Boolean value indicating whether a specified role exists.</span></span>

<span data-ttu-id="5d3e2-198">Nella prossima esercitazione verrà esaminato associare gli utenti a ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-198">In the next tutorial we will examine how to associate users with roles.</span></span> <span data-ttu-id="5d3e2-199">Il `Roles` della classe [ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [ `AddUserToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [ `AddUsersToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), e [ `AddUsersToRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) metodi consentono di aggiungere uno o più utenti a uno o più ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-199">The `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx), [`AddUserToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.addusertoroles.aspx), [`AddUsersToRole`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstorole.aspx), and [`AddUsersToRoles`](https://msdn.microsoft.com/library/system.web.security.roles.adduserstoroles.aspx) methods add one or more users to one or more roles.</span></span> <span data-ttu-id="5d3e2-200">Per rimuovere utenti dai ruoli, utilizzare il [ `RemoveUserFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [ `RemoveUserFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [ `RemoveUsersFromRole` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), o [ `RemoveUsersFromRoles` ](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) metodi.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-200">To remove users from roles, use the [`RemoveUserFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx), [`RemoveUserFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromroles.aspx), [`RemoveUsersFromRole`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromrole.aspx), or [`RemoveUsersFromRoles`](https://msdn.microsoft.com/library/system.web.security.roles.removeusersfromroles.aspx) methods.</span></span>

<span data-ttu-id="5d3e2-201">Nel <a id="_msoanchor_9"> </a> [ *autorizzazione basata sui ruoli* ](role-based-authorization-vb.md) esercitazione verranno esaminati modi per livello di codice Mostra o nasconde la funzionalità in base al ruolo dell'utente attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-201">In the <a id="_msoanchor_9"></a>[*Role-Based Authorization*](role-based-authorization-vb.md) tutorial we will look at ways to programmatically show or hide functionality based on the currently logged in user's role.</span></span> <span data-ttu-id="5d3e2-202">A tale scopo, è possibile utilizzare la classe di ruoli [ `FindUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [ `GetRolesForUser` ](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [ `GetUsersInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), o [ `IsUserInRole` ](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) metodi.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-202">To accomplish this, we can use the Role class's [`FindUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.findusersinrole.aspx), [`GetRolesForUser`](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx), [`GetUsersInRole`](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx), or [`IsUserInRole`](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx) methods.</span></span>

> [!NOTE]
> <span data-ttu-id="5d3e2-203">Tenere presente che viene richiamato ogni volta che uno di questi metodi, il `Roles` classe delega la chiamata al provider configurato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-203">Keep in mind that any time one of these methods is invoked, the `Roles` class delegates the call to the configured provider.</span></span> <span data-ttu-id="5d3e2-204">In questo caso, ciò significa che la chiamata viene inviata al `SqlRoleProvider`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-204">In our case, this means that the call is being sent to the `SqlRoleProvider`.</span></span> <span data-ttu-id="5d3e2-205">Il `SqlRoleProvider` quindi esegue l'operazione di database appropriato in base al metodo richiamato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-205">The `SqlRoleProvider` then performs the appropriate database operation based on the invoked method.</span></span> <span data-ttu-id="5d3e2-206">Ad esempio, il codice `Roles.CreateRole("Administrators")` comporta il `SqlRoleProvider` l'esecuzione il `aspnet_Roles_CreateRole` stored procedure che inserisce un nuovo record nel `aspnet_Roles` tabella denominata Administrators.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-206">For example, the code `Roles.CreateRole("Administrators")` results in the `SqlRoleProvider` executing the `aspnet_Roles_CreateRole` stored procedure, which inserts a new record into the `aspnet_Roles` table named Administrators .</span></span>


<span data-ttu-id="5d3e2-207">Il resto di questa esercitazione vengono esaminati mediante il `Roles` della classe `CreateRole`, `GetAllRoles`, e `DeleteRole` metodi per gestire i ruoli del sistema.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-207">The remainder of this tutorial looks at using the `Roles` class's `CreateRole`, `GetAllRoles`, and `DeleteRole` methods to manage the roles in the system.</span></span>

## <a name="step-4-creating-new-roles"></a><span data-ttu-id="5d3e2-208">Passaggio 4: Creazione di nuovi ruoli</span><span class="sxs-lookup"><span data-stu-id="5d3e2-208">Step 4: Creating New Roles</span></span>

<span data-ttu-id="5d3e2-209">Ruoli offrono un modo per raggruppare arbitrariamente gli utenti, e in genere questo raggruppamento viene utilizzato per applicare le regole di autorizzazione in modo più semplice.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-209">Roles offer a way to arbitrarily group users, and most commonly this grouping is used for a more convenient way to apply authorization rules.</span></span> <span data-ttu-id="5d3e2-210">Tuttavia, per utilizzare i ruoli come un meccanismo di autorizzazione è innanzitutto necessario definire i ruoli presenti nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-210">But in order to use roles as an authorization mechanism we first need to define what roles exist in the application.</span></span> <span data-ttu-id="5d3e2-211">Purtroppo, ASP.NET non include un controllo CreateRoleWizard.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-211">Unfortunately, ASP.NET does not include a CreateRoleWizard control.</span></span> <span data-ttu-id="5d3e2-212">Per aggiungere nuovi ruoli, che è necessario creare un'interfaccia utente appropriata e richiamare l'API di ruoli effettuata.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-212">In order to add new roles we need to create a suitable user interface and invoke the Roles API ourselves.</span></span> <span data-ttu-id="5d3e2-213">Buone notizie sono che questo è molto facile da eseguire.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-213">The good news is that this is very easy to accomplish.</span></span>

> [!NOTE]
> <span data-ttu-id="5d3e2-214">Benché sia presente alcun controllo CreateRoleWizard Web, è il [strumento Amministrazione sito Web ASP.NET](https://msdn.microsoft.com/library/ms228053.aspx), che è un'applicazione ASP.NET locale progettata per facilitare la visualizzazione e la gestione della configurazione dell'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-214">While there is no CreateRoleWizard Web control, there is the [ASP.NET Web Site Administration Tool](https://msdn.microsoft.com/library/ms228053.aspx), which is a local ASP.NET application designed to assist with viewing and managing your web application's configuration.</span></span> <span data-ttu-id="5d3e2-215">Tuttavia, non si è un grande fan dello strumento Amministrazione sito Web ASP.NET per due motivi.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-215">However, I am not a big fan of the ASP.NET Web Site Administration Tool for two reasons.</span></span> <span data-ttu-id="5d3e2-216">Innanzitutto, è un po' anomalo e l'esperienza utente migliorate per essere desiderato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-216">First, it is a bit buggy and the user experience leaves a lot to be desired.</span></span> <span data-ttu-id="5d3e2-217">In secondo luogo, lo strumento Amministrazione sito Web di ASP.NET è progettato per funzionare solo in locale, vale a dire che è necessario compilare il proprio ruolo pagine web di gestione, se si desidera gestire in remoto i ruoli in un sito in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-217">Second, the ASP.NET Web Site Administration Tool is designed to only work locally, meaning that you will have to build your own role management web pages if you need to manage roles on a live site remotely.</span></span> <span data-ttu-id="5d3e2-218">Per questi motivi, in questa esercitazione e la successiva esaminerà in compilazione il ruolo necessario strumenti di gestione in una pagina web, anziché utilizzare lo strumento Amministrazione sito Web di ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-218">For these two reasons, this tutorial and the next will focus on building the necessary role management tools in a web page rather than relying on the ASP.NET Web Site Administration Tool.</span></span>


<span data-ttu-id="5d3e2-219">Aprire il `ManageRoles.aspx` nella pagina di `Roles` cartella e aggiungere una casella di testo e un controllo pulsante Web alla pagina.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-219">Open the `ManageRoles.aspx` page in the `Roles` folder and add a TextBox and a Button Web control to the page.</span></span> <span data-ttu-id="5d3e2-220">Impostare il controllo TextBox `ID` proprietà `RoleName` e il pulsante `ID` e `Text` proprietà `CreateRoleButton` e Create Role, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-220">Set the TextBox control's `ID` property to `RoleName` and the Button's `ID` and `Text` properties to `CreateRoleButton` and Create Role, respectively.</span></span> <span data-ttu-id="5d3e2-221">A questo punto, markup dichiarativo della pagina dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-221">At this point, your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample6.aspx)]

<span data-ttu-id="5d3e2-222">Successivamente, fare doppio clic su di `CreateRoleButton` pulsante di controllo nella finestra di progettazione per creare un `Click` gestore dell'evento e quindi aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-222">Next, double-click the `CreateRoleButton` Button control in the Designer to create a `Click` event handler and then add the following code:</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample7.vb)]

<span data-ttu-id="5d3e2-223">Il codice sopra riportato avvia assegnando il nome del ruolo tagliati immesso nel `RoleName` casella di testo per il `newRoleName` variabile.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-223">The above code starts by assigning the trimmed role name entered in the `RoleName` TextBox to the `newRoleName` variable.</span></span> <span data-ttu-id="5d3e2-224">Successivamente, il `Roles` della classe `RoleExists` metodo viene chiamato per determinare se il ruolo `newRoleName` esiste già nel sistema.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-224">Next, the `Roles` class's `RoleExists` method is called to determine if the role `newRoleName` already exists in the system.</span></span> <span data-ttu-id="5d3e2-225">Se il ruolo non esiste, viene creato mediante una chiamata al `CreateRole` metodo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-225">If the role does not exist, it is created via a call to the `CreateRole` method.</span></span> <span data-ttu-id="5d3e2-226">Se il `CreateRole` viene passato un nome di ruolo esiste già nel sistema, un `ProviderException` viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-226">If the `CreateRole` method is passed a role name that already exists in the system, a `ProviderException` exception is thrown.</span></span> <span data-ttu-id="5d3e2-227">Ecco perché il codice controlla per verificare che il ruolo non esiste già nel sistema prima di chiamare `CreateRole`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-227">This is why the code first checks to ensure that the role does not already exist in the system before calling `CreateRole`.</span></span> <span data-ttu-id="5d3e2-228">Il `Click` dell'operazione del gestore di evento cancellando la `RoleName` della casella di testo `Text` proprietà.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-228">The `Click` event handler concludes by clearing out the `RoleName` TextBox's `Text` property.</span></span>

> [!NOTE]
> <span data-ttu-id="5d3e2-229">Per comprendere che cosa accade se l'utente non immette un valore nel `RoleName` casella di testo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-229">You may be wondering what will happen if the user doesn't enter any value into the `RoleName` TextBox.</span></span> <span data-ttu-id="5d3e2-230">Se il valore passato al `CreateRole` metodo `Nothing` o una stringa vuota, un'eccezione viene generata.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-230">If the value passed into the `CreateRole` method is `Nothing` or an empty string, an exception is raised.</span></span> <span data-ttu-id="5d3e2-231">Analogamente, se il nome del ruolo contiene una virgola viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-231">Likewise, if the role name contains a comma an exception is raised.</span></span> <span data-ttu-id="5d3e2-232">Di conseguenza, la pagina deve contenere i controlli di convalida per verificare che l'utente immette un ruolo e che non contiene virgole.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-232">Consequently, the page should contain validation controls to ensure that the user enters a role and that it does not contain any commas.</span></span> <span data-ttu-id="5d3e2-233">Lasciare un esercizio per il lettore.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-233">I leave as an exercise for the reader.</span></span>


<span data-ttu-id="5d3e2-234">Creare un ruolo denominato Administrators.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-234">Let's create a role named Administrators.</span></span> <span data-ttu-id="5d3e2-235">Visitare il `ManageRoles.aspx` tramite un browser, digitare negli amministratori nella casella di testo (vedere Figura 3), quindi fare clic sul pulsante Crea ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-235">Visit the `ManageRoles.aspx` page through a browser, type in Administrators into the textbox (see Figure 3), and then click the Create Role button.</span></span>


<span data-ttu-id="5d3e2-236">[![Creare un ruolo di amministratori](creating-and-managing-roles-vb/_static/image8.png)](creating-and-managing-roles-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-236">[![Create an Administrators Role](creating-and-managing-roles-vb/_static/image8.png)](creating-and-managing-roles-vb/_static/image7.png)</span></span>

<span data-ttu-id="5d3e2-237">**Figura 3**: creare un ruolo di amministratori ([fare clic per visualizzare l'immagine ingrandita](creating-and-managing-roles-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="5d3e2-237">**Figure 3**: Create an Administrators Role  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image9.png))</span></span>


<span data-ttu-id="5d3e2-238">Che succede?</span><span class="sxs-lookup"><span data-stu-id="5d3e2-238">What happens?</span></span> <span data-ttu-id="5d3e2-239">Si verifica un postback, ma non esiste alcun segnale visivo che il ruolo sia stato effettivamente aggiunti al sistema.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-239">A postback occurs, but there's no visual cue that the role has actually been added to the system.</span></span> <span data-ttu-id="5d3e2-240">Questa pagina nel passaggio 5 per includere indicazioni visive verrà aggiornato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-240">We will update this page in Step 5 to include visual feedback.</span></span> <span data-ttu-id="5d3e2-241">Per il momento, tuttavia, è possibile verificare che il ruolo è stato creato, passare al `SecurityTutorials.mdf` database e la visualizzazione dei dati di `aspnet_Roles` tabella.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-241">For now, however, you can verify that the role was created by going to the `SecurityTutorials.mdf` database and displaying the data from the `aspnet_Roles` table.</span></span> <span data-ttu-id="5d3e2-242">Come illustrato nella figura 4, il `aspnet_Roles` tabella include un record per i ruoli di amministratori appena aggiunti.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-242">As Figure 4 shows, the `aspnet_Roles` table contains a record for the just-added Administrators roles.</span></span>


<span data-ttu-id="5d3e2-243">[![Aspnet_Roles tabella dispone di una riga per gli amministratori](creating-and-managing-roles-vb/_static/image11.png)](creating-and-managing-roles-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-243">[![The aspnet_Roles Table has a Row for the Administrators](creating-and-managing-roles-vb/_static/image11.png)](creating-and-managing-roles-vb/_static/image10.png)</span></span>

<span data-ttu-id="5d3e2-244">**Figura 4**: il `aspnet_Roles` tabella contiene una riga per gli amministratori ([fare clic per visualizzare l'immagine ingrandita](creating-and-managing-roles-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="5d3e2-244">**Figure 4**: The `aspnet_Roles` Table has a Row for the Administrators  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image12.png))</span></span>


## <a name="step-5-displaying-the-roles-in-the-system"></a><span data-ttu-id="5d3e2-245">Passaggio 5: Visualizzare i ruoli del sistema</span><span class="sxs-lookup"><span data-stu-id="5d3e2-245">Step 5: Displaying the Roles in the System</span></span>

<span data-ttu-id="5d3e2-246">Consente di aumentare la `ManageRoles.aspx` pagina per includere un elenco di ruoli correnti nel sistema.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-246">Let's augment the `ManageRoles.aspx` page to include a list of the current roles in the system.</span></span> <span data-ttu-id="5d3e2-247">A tale scopo, aggiungere un controllo GridView alla pagina e impostare il relativo `ID` proprietà `RoleList`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-247">To accomplish this, add a GridView control to the page and set its `ID` property to `RoleList`.</span></span> <span data-ttu-id="5d3e2-248">Successivamente, aggiungere un metodo alla classe code-behind della pagina denominata `DisplayRolesInGrid` utilizzando il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-248">Next, add a method to the page's code-behind class named `DisplayRolesInGrid` using the following code:</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample8.vb)]

<span data-ttu-id="5d3e2-249">Il `Roles` della classe `GetAllRoles` metodo restituisce tutti i ruoli del sistema come una matrice di stringhe.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-249">The `Roles` class's `GetAllRoles` method returns all of the roles in the system as an array of strings.</span></span> <span data-ttu-id="5d3e2-250">Questa matrice di stringhe viene quindi associata a GridView.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-250">This string array is then bound to the GridView.</span></span> <span data-ttu-id="5d3e2-251">Per associare l'elenco di ruoli a GridView, al primo caricamento della pagina, è necessario chiamare il `DisplayRolesInGrid` metodo della pagina `Page_Load` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-251">In order to bind the list of roles to the GridView when the page is first loaded, we need to call the `DisplayRolesInGrid` method from the page's `Page_Load` event handler.</span></span> <span data-ttu-id="5d3e2-252">Il codice seguente chiama questo metodo quando viene innanzitutto visitata, ma non nei postback successivi.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-252">The following code calls this method when the page is first visited, but not on subsequent postbacks.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample9.vb)]

<span data-ttu-id="5d3e2-253">Con questo codice, visitare la pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-253">With this code in place, visit the page through a browser.</span></span> <span data-ttu-id="5d3e2-254">Come illustrato nella figura 5, verrà visualizzata una griglia con una singola colonna con etichetta di elemento.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-254">As Figure 5 shows, you should see a grid with a single column labeled Item.</span></span> <span data-ttu-id="5d3e2-255">La griglia include una riga per il ruolo di amministratore che è aggiunto nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-255">The grid includes a row for the Administrators role we added in Step 4.</span></span>


<span data-ttu-id="5d3e2-256">[![GridView Visualizza i ruoli in un'unica colonna](creating-and-managing-roles-vb/_static/image14.png)](creating-and-managing-roles-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-256">[![The GridView Displays the Roles in a Single Column](creating-and-managing-roles-vb/_static/image14.png)](creating-and-managing-roles-vb/_static/image13.png)</span></span>

<span data-ttu-id="5d3e2-257">**Figura 5**: GridView Visualizza i ruoli in un'unica colonna ([fare clic per visualizzare l'immagine ingrandita](creating-and-managing-roles-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="5d3e2-257">**Figure 5**: The GridView Displays the Roles in a Single Column  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image15.png))</span></span>


<span data-ttu-id="5d3e2-258">GridView Visualizza una colonna singola con l'etichetta di elemento perché il controllo GridView `AutoGenerateColumns` è impostata su True (impostazione predefinita), provocando GridView creare automaticamente una colonna per ogni proprietà nel relativo `DataSource`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-258">The GridView displays a lone column labeled Item because the GridView's `AutoGenerateColumns` property is set to True (the default), which causes the GridView to automatically create a column for each property in its `DataSource`.</span></span> <span data-ttu-id="5d3e2-259">Matrice con un'unica proprietà che rappresenta gli elementi nella matrice, pertanto la singola colonna in GridView.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-259">An array has a single property that represents the elements in the array, hence the single column in the GridView.</span></span>

<span data-ttu-id="5d3e2-260">Quando si visualizzano i dati con un controllo GridView, è preferibile in modo esplicito definire colonne anziché generarli in modo implicito dal controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-260">When displaying data with a GridView, I prefer to explicitly define my columns rather than have them implicitly generated by the GridView.</span></span> <span data-ttu-id="5d3e2-261">Definendo in modo esplicito le colonne è molto più semplice formattare i dati, ridisporre le colonne ed eseguire altre attività comuni.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-261">By explicitly defining the columns it is much easier to format the data, rearrange the columns, and perform other common tasks.</span></span> <span data-ttu-id="5d3e2-262">Di conseguenza, si aggiornare markup dichiarativo del controllo GridView in modo che le colonne definite in modo esplicito.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-262">Therefore, let's update the GridView's declarative markup so that its columns are explicitly defined.</span></span>

<span data-ttu-id="5d3e2-263">Iniziare con la configurazione del controllo GridView `AutoGenerateColumns` la proprietà su False.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-263">Start by setting the GridView's `AutoGenerateColumns` property to False.</span></span> <span data-ttu-id="5d3e2-264">Successivamente, aggiungere un TemplateField alla griglia, impostare il relativo `HeaderText` proprietà ai ruoli e configurare il `ItemTemplate` in modo che venga visualizzato il contenuto della matrice.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-264">Next, add a TemplateField to the grid, set its `HeaderText` property to Roles, and configure its `ItemTemplate` so that it displays the contents of the array.</span></span> <span data-ttu-id="5d3e2-265">A tale scopo, aggiungere un controllo etichetta Web denominato `RoleNameLabel` per il `ItemTemplate` e associare il `Text` proprietà`Container.DataItem.`</span><span class="sxs-lookup"><span data-stu-id="5d3e2-265">To accomplish this, add a Label Web control named `RoleNameLabel` to the `ItemTemplate` and bind its `Text` property to `Container.DataItem.`</span></span>

<span data-ttu-id="5d3e2-266">Queste proprietà e `ItemTemplate`del contenuto può essere impostato in modo dichiarativo o tramite la finestra di dialogo di campi del controllo GridView e interfaccia di modifica modelli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-266">These properties and the `ItemTemplate`'s contents can be set declaratively or through the GridView's Fields dialog box and Edit Templates interface.</span></span> <span data-ttu-id="5d3e2-267">Per raggiungere i campi la finestra di dialogo, fare clic sul collegamento di modifica colonne nello Smart Tag del controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-267">To reach the Fields dialog box, click the Edit Columns link in the GridView's Smart Tag.</span></span> <span data-ttu-id="5d3e2-268">Successivamente, deselezionare l'opzione genera automaticamente i campi casella di controllo per impostare il `AutoGenerateColumns` la proprietà su False e aggiungervi un TemplateField GridView, impostando il relativo `HeaderText` proprietà al ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-268">Next, uncheck the Auto-generate fields checkbox to set the `AutoGenerateColumns` property to False, and add a TemplateField to the GridView, setting its `HeaderText` property to Role.</span></span> <span data-ttu-id="5d3e2-269">Per definire il `ItemTemplate`del contenuto, scegliere l'opzione di modifica modelli dal Smart Tag del controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-269">To define the `ItemTemplate`'s contents, choose the Edit Templates option from the GridView's Smart Tag.</span></span> <span data-ttu-id="5d3e2-270">Trascinare un controllo etichetta Web il `ItemTemplate`, impostare il `ID` proprietà `RoleNameLabel`e configurare le impostazioni di associazione dati in modo che il `Text` proprietà è associata a `Container.DataItem`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-270">Drag a Label Web control onto the `ItemTemplate`, set its `ID` property to `RoleNameLabel`, and configure its databinding settings so that its `Text` property is bound to `Container.DataItem`.</span></span>

<span data-ttu-id="5d3e2-271">Indipendentemente dal quale approccio adottato, dichiarativo del controllo GridView risulta dovrebbe essere simile al seguente al termine.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-271">Regardless of what approach you use, the GridView's resulting declarative markup should look similar to the following when you are done.</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample10.aspx)]

> [!NOTE]
> <span data-ttu-id="5d3e2-272">Contenuto della matrice viene visualizzato utilizzando la sintassi di associazione dati `<%# Container.DataItem %>`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-272">The array's contents are displayed using the databinding syntax `<%# Container.DataItem %>`.</span></span> <span data-ttu-id="5d3e2-273">Una descrizione completa dei motivi per cui questa sintassi è utilizzata quando il contenuto di una matrice di visualizzazione associato a GridView non rientra nell'ambito di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-273">A thorough description of why this syntax is used when displaying the contents of an array bound to the GridView is beyond the scope of this tutorial.</span></span> <span data-ttu-id="5d3e2-274">Per ulteriori informazioni al riguardo, vedere [l'associazione di una matrice scalare per un controllo Web](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-274">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>


<span data-ttu-id="5d3e2-275">Attualmente, il `RoleList` GridView è associato solo all'elenco dei ruoli prima visita la pagina.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-275">Currently, the `RoleList` GridView is only bound to the list of roles when the page is first visited.</span></span> <span data-ttu-id="5d3e2-276">È necessario aggiornare la griglia ogni volta che viene aggiunto un nuovo ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-276">We need to refresh the grid whenever a new role is added.</span></span> <span data-ttu-id="5d3e2-277">A tale scopo, aggiornare il `CreateRoleButton` del pulsante `Click` gestore dell'evento in modo che venga chiamato il `DisplayRolesInGrid` metodo se viene creato un nuovo ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-277">To accomplish this, update the `CreateRoleButton` Button's `Click` event handler so that it calls the `DisplayRolesInGrid` method if a new role is created.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample11.vb)]

<span data-ttu-id="5d3e2-278">A questo punto quando l'utente aggiunge un nuovo ruolo di `RoleList` GridView viene illustrato il ruolo appena aggiunti durante il postback, fornire feedback visivo che il ruolo è stato creato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-278">Now when the user adds a new role the `RoleList` GridView shows the just-added role on postback, providing visual feedback that the role was successfully created.</span></span> <span data-ttu-id="5d3e2-279">A questo scopo, visitare il `ManageRoles.aspx` pagina tramite un browser e aggiungere un ruolo denominato supervisori.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-279">To illustrate this, visit the `ManageRoles.aspx` page through a browser and add a role named Supervisors.</span></span> <span data-ttu-id="5d3e2-280">Fare clic sul pulsante Create Role, su un postback verrà insorgere e la griglia verrà aggiornata per includere gli amministratori, nonché il nuovo ruolo, mentre per i supervisori.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-280">Upon clicking the Create Role button, a postback will ensue and the grid will update to include Administrators as well as the new role, Supervisors.</span></span>


<span data-ttu-id="5d3e2-281">[![Il ruolo supervisori è stato aggiunto](creating-and-managing-roles-vb/_static/image17.png)](creating-and-managing-roles-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-281">[![The Supervisors Role has Been Added](creating-and-managing-roles-vb/_static/image17.png)](creating-and-managing-roles-vb/_static/image16.png)</span></span>

<span data-ttu-id="5d3e2-282">**Figura 6**: supervisori ruolo è stato aggiunto ([fare clic per visualizzare l'immagine ingrandita](creating-and-managing-roles-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="5d3e2-282">**Figure 6**: The Supervisors Role has Been Added  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image18.png))</span></span>


## <a name="step-6-deleting-roles"></a><span data-ttu-id="5d3e2-283">Passaggio 6: Eliminazione di ruoli</span><span class="sxs-lookup"><span data-stu-id="5d3e2-283">Step 6: Deleting Roles</span></span>

<span data-ttu-id="5d3e2-284">A questo punto un utente può creare un nuovo ruolo e visualizzare tutti i ruoli esistenti dal `ManageRoles.aspx` pagina.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-284">At this point a user can create a new role and view all existing roles from the `ManageRoles.aspx` page.</span></span> <span data-ttu-id="5d3e2-285">Si consente agli utenti di eliminare anche i ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-285">Let's allow users to also delete roles.</span></span> <span data-ttu-id="5d3e2-286">Il `Roles.DeleteRole` metodo dispone di due overload:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-286">The `Roles.DeleteRole` method has two overloads:</span></span>

- <span data-ttu-id="5d3e2-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx)-Elimina il ruolo *roleName*.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-287">[`DeleteRole(roleName)`](https://msdn.microsoft.com/library/ek4sywc0.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="5d3e2-288">Se il ruolo contiene uno o più membri, viene generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-288">An exception is thrown if the role contains one or more members.</span></span>
- <span data-ttu-id="5d3e2-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx)-Elimina il ruolo *roleName*.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-289">[`DeleteRole(roleName, throwOnPopulatedRole)`](https://msdn.microsoft.com/library/38h6wf59.aspx) - deletes the role *roleName*.</span></span> <span data-ttu-id="5d3e2-290">Se *throwOnPopulateRole* è `True`, viene generata un'eccezione se il ruolo contiene uno o più membri.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-290">If *throwOnPopulateRole* is `True`, then an exception is thrown if the role contains one or more members.</span></span> <span data-ttu-id="5d3e2-291">Se *throwOnPopulateRole* è `False`, quindi viene eliminato il ruolo se o non contiene membri.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-291">If *throwOnPopulateRole* is `False`, then the role is deleted whether it contains any members or not.</span></span> <span data-ttu-id="5d3e2-292">Internamente, il `DeleteRole(roleName)` chiamate al metodo `DeleteRole(roleName, True)`.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-292">Internally, the `DeleteRole(roleName)` method calls `DeleteRole(roleName, True)`.</span></span>

<span data-ttu-id="5d3e2-293">Il `DeleteRole` metodo genererà un'eccezione anche se *roleName* è `Nothing` o una stringa vuota o se *roleName* contiene una virgola.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-293">The `DeleteRole` method will also throw an exception if *roleName* is `Nothing` or an empty string or if *roleName* contains a comma.</span></span> <span data-ttu-id="5d3e2-294">Se *roleName* non esiste nel sistema, `DeleteRole` non riesce senza avvisare, senza generare un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-294">If *roleName* does not exist in the system, `DeleteRole` fails silently, without raising an exception.</span></span>

<span data-ttu-id="5d3e2-295">Consente di aumentare GridView in `ManageRoles.aspx` per includere un pulsante Elimina che, quando si fa clic, Elimina il ruolo selezionato.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-295">Let's augment the GridView in `ManageRoles.aspx` to include a Delete button that, when clicked, deletes the selected role.</span></span> <span data-ttu-id="5d3e2-296">Per iniziare, aggiungere un pulsante Elimina a GridView, riaprire la finestra di dialogo campi e aggiunta di un pulsante Elimina, che si trova sotto l'opzione CommandField.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-296">Start by adding a Delete button to the GridView by going to the Fields dialog box and adding a Delete button, which is located under the CommandField option.</span></span> <span data-ttu-id="5d3e2-297">Verificare l'eliminazione pulsante colonna all'estrema sinistra e impostare il relativo `DeleteText` proprietà eliminare ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-297">Make the Delete button the far left column and set its `DeleteText` property to Delete Role .</span></span>


<span data-ttu-id="5d3e2-298">[![Aggiungere un pulsante Elimina a RoleList GridView](creating-and-managing-roles-vb/_static/image20.png)](creating-and-managing-roles-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-298">[![Add a Delete Button to the RoleList GridView](creating-and-managing-roles-vb/_static/image20.png)](creating-and-managing-roles-vb/_static/image19.png)</span></span>

<span data-ttu-id="5d3e2-299">**Figura 7**: aggiungere un pulsante di eliminare il `RoleList` GridView ([fare clic per visualizzare l'immagine ingrandita](creating-and-managing-roles-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="5d3e2-299">**Figure 7**: Add a Delete Button to the `RoleList` GridView  ([Click to view full-size image](creating-and-managing-roles-vb/_static/image21.png))</span></span>


<span data-ttu-id="5d3e2-300">Dopo aver aggiunto il pulsante Elimina, markup dichiarativo di GridView dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-300">After adding the Delete button, your GridView's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-and-managing-roles-vb/samples/sample12.aspx)]

<span data-ttu-id="5d3e2-301">Successivamente, creare un gestore eventi per il controllo GridView `RowDeleting` evento.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-301">Next, create an event handler for the GridView's `RowDeleting` event.</span></span> <span data-ttu-id="5d3e2-302">Questo è l'evento generato durante il postback quando si fa clic sul pulsante Elimina ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-302">This is the event that is raised on postback when the Delete Role button is clicked.</span></span> <span data-ttu-id="5d3e2-303">Aggiungere il codice seguente al gestore eventi.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-303">Add the following code to the event handler.</span></span>

[!code-vb[Main](creating-and-managing-roles-vb/samples/sample13.vb)]

<span data-ttu-id="5d3e2-304">Il codice di avvio facendo riferimento a livello di codice il `RoleNameLabel` controllo nella riga il cui pulsante Elimina ruolo Web.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-304">The code starts by programmatically referencing the `RoleNameLabel` Web control in the row whose Delete Role button was clicked.</span></span> <span data-ttu-id="5d3e2-305">Il `Roles.DeleteRole` viene quindi richiamato metodo, passando il `Text` del `RoleNameLabel` e `False`, quindi eliminare il ruolo, indipendentemente dal fatto che vi sono utenti associati al ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-305">The `Roles.DeleteRole` method is then invoked, passing in the `Text` of the `RoleNameLabel` and `False`, thereby deleting the role regardless of whether there are any users associated with the role.</span></span> <span data-ttu-id="5d3e2-306">Infine, il `RoleList` GridView viene aggiornato in modo che il ruolo appena eliminato non viene più visualizzata nella griglia.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-306">Finally, the `RoleList` GridView is refreshed so that the just-deleted role no longer appears in the grid.</span></span>

> [!NOTE]
> <span data-ttu-id="5d3e2-307">Pulsante Elimina ruolo non è necessaria una sorta di conferma da parte dell'utente prima di eliminare il ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-307">The Delete Role button does not require any sort of confirmation from the user before deleting the role.</span></span> <span data-ttu-id="5d3e2-308">Uno dei modi più semplici per confermare un'azione avviene tramite una finestra di dialogo di conferma sul lato client.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-308">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="5d3e2-309">Per ulteriori informazioni su questa tecnica, vedere [aggiunta sul lato Client conferma quando l'eliminazione di](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-309">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span></span>


## <a name="summary"></a><span data-ttu-id="5d3e2-310">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="5d3e2-310">Summary</span></span>

<span data-ttu-id="5d3e2-311">Molte applicazioni web sono determinate regole di autorizzazione o una funzionalità a livello di pagina è disponibile solo per alcune classi di utenti.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-311">Many web applications have certain authorization rules or page-level functionality that is only available to certain classes of users.</span></span> <span data-ttu-id="5d3e2-312">Ad esempio, potrebbe essere un set di pagine web che solo gli amministratori possono accedere.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-312">For example, there may be a set of web pages that only administrators can access.</span></span> <span data-ttu-id="5d3e2-313">Invece di definire le regole di autorizzazione su base utente dall'utente, spesso è più utile definire le regole in base a un ruolo.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-313">Rather than defining these authorization rules on a user-by-user basis, oftentimes it is more useful to define the rules based on a role.</span></span> <span data-ttu-id="5d3e2-314">Anziché consentire esplicitamente agli utenti Scott e Jisun per accedere alle pagine web di amministrazione, un approccio migliore è per consentire l'accesso alle singole pagine, i membri del ruolo amministratori e quindi indicare Scott e Jisun come appartenenti a utenti di Ruolo di amministratore.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-314">That is, rather than explicitly allowing users Scott and Jisun to access the administrative web pages, a more maintainable approach is to permit members of the Administrators role to access these pages, and then to denote Scott and Jisun as users belonging to the Administrators role.</span></span>

<span data-ttu-id="5d3e2-315">Il framework di ruoli è semplice creare e gestire i ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-315">The Roles framework makes it easy to create and manage roles.</span></span> <span data-ttu-id="5d3e2-316">In questa esercitazione viene esaminato come configurare il framework di ruoli da utilizzare il `SqlRoleProvider`, che utilizza un database di Microsoft SQL Server come archivio ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-316">In this tutorial we examined how to configure the Roles framework to use the `SqlRoleProvider`, which uses a Microsoft SQL Server database as the role store.</span></span> <span data-ttu-id="5d3e2-317">È stato anche creato una pagina web che elenca i ruoli esistenti nel sistema e consente di creare nuovi ruoli del e quelli esistenti da eliminare.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-317">We also created a web page that lists the existing roles in the system and allows for new roles to be created and existing ones to be deleted.</span></span> <span data-ttu-id="5d3e2-318">Nelle esercitazioni successive verrà spiegato come assegnare utenti a ruoli e come applicare l'autorizzazione basata sui ruoli.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-318">In subsequent tutorials we will see how to assign users to roles and how to apply role-based authorization.</span></span>

<span data-ttu-id="5d3e2-319">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="5d3e2-319">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="5d3e2-320">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="5d3e2-320">Further Reading</span></span>

<span data-ttu-id="5d3e2-321">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="5d3e2-321">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="5d3e2-322">Analisi di ASP.NET 2.0 appartenenza, ruoli e profilo</span><span class="sxs-lookup"><span data-stu-id="5d3e2-322">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="5d3e2-323">Procedura: Utilizzare Gestione ruoli in ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="5d3e2-323">How To: Use Role Manager in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/ms998314.aspx)
- [<span data-ttu-id="5d3e2-324">Provider di ruoli</span><span class="sxs-lookup"><span data-stu-id="5d3e2-324">Role Providers</span></span>](https://msdn.microsoft.com/library/aa478950.aspx)
- [<span data-ttu-id="5d3e2-325">Strumento Amministrazione sito Web in sequenza</span><span class="sxs-lookup"><span data-stu-id="5d3e2-325">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)
- [<span data-ttu-id="5d3e2-326">Documentazione tecnica per il `<roleManager>` elemento</span><span class="sxs-lookup"><span data-stu-id="5d3e2-326">Technical documentation for the `<roleManager>` Element</span></span>](https://msdn.microsoft.com/library/ms164660.aspx)
- [<span data-ttu-id="5d3e2-327">Tramite l'appartenenza e l'API di gestione di ruolo</span><span class="sxs-lookup"><span data-stu-id="5d3e2-327">Using the Membership and Role Manager APIs</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/membership.aspx)

### <a name="about-the-author"></a><span data-ttu-id="5d3e2-328">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="5d3e2-328">About the Author</span></span>

<span data-ttu-id="5d3e2-329">Scott Mitchell, autore di più libri e fondatore di 4GuysFromRolla, ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-329">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5d3e2-330">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-330">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5d3e2-331">Il suo ultimo libro è  *[SAM insegna manualmente ASP.NET 2.0 nelle 24 ore](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-331">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="5d3e2-332">Scott può essere raggiunto al [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) o tramite il suo blog all'indirizzo [http://ScottOnWriting.NET](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="5d3e2-332">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="5d3e2-333">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="5d3e2-333">Special Thanks To</span></span>

<span data-ttu-id="5d3e2-334">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-334">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="5d3e2-335">Lead revisori per questa esercitazione includono Alicja Maziarz Suchi Banerjee e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="5d3e2-335">Lead reviewers for this tutorial include Alicja Maziarz, Suchi Banerjee, and Teresa Murphy.</span></span> <span data-ttu-id="5d3e2-336">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="5d3e2-336">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5d3e2-337">In caso affermativo, Inviami una riga alla[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-337">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="5d3e2-338">[Precedente](role-based-authorization-cs.md)
[Successivo](assigning-roles-to-users-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5d3e2-338">[Previous](role-based-authorization-cs.md)
[Next](assigning-roles-to-users-vb.md)</span></span>
