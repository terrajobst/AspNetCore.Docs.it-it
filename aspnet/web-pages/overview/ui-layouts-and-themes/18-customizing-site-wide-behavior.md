---
uid: web-pages/overview/ui-layouts-and-themes/18-customizing-site-wide-behavior
title: Personalizzazione del comportamento a livello di sito per ASP.NET Web Pages siti (Razor) | Documenti Microsoft
author: tfitzmac
description: "In questo capitolo viene illustrato come creare le impostazioni per l'intero sito Web o un'intera cartella, anziché una pagina."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/17/2014
ms.topic: article
ms.assetid: e158bed7-226f-4275-b02e-7553bd58c669
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/ui-layouts-and-themes/18-customizing-site-wide-behavior
msc.type: authoredcontent
ms.openlocfilehash: b1caa26a23517bd976addfefac89375ae965eb91
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/10/2017
---
<a name="customizing-site-wide-behavior-for-aspnet-web-pages-razor-sites"></a><span data-ttu-id="e384e-103">Personalizzazione del comportamento a livello di sito per i siti Web ASP.NET (Razor) pagine</span><span class="sxs-lookup"><span data-stu-id="e384e-103">Customizing Site-Wide Behavior for ASP.NET Web Pages (Razor) Sites</span></span>
====================
<span data-ttu-id="e384e-104">da [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="e384e-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="e384e-105">In questo articolo viene illustrato come creare impostazioni sito-side per le pagine in un sito Web ASP.NET Web Pages (Razor).</span><span class="sxs-lookup"><span data-stu-id="e384e-105">This article explains how to make site-side settings for pages in an ASP.NET Web Pages (Razor) website.</span></span>
> 
> <span data-ttu-id="e384e-106">Illustra quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-106">What you'll learn:</span></span>
> 
> - <span data-ttu-id="e384e-107">Come eseguire il codice che consente di set di valori (valori globali o le impostazioni di supporto) per tutte le pagine in un sito.</span><span class="sxs-lookup"><span data-stu-id="e384e-107">How to run code that lets you set values (global values or helper settings) for all pages in a site.</span></span>
> - <span data-ttu-id="e384e-108">Come eseguire il codice che consente di impostare valori per tutte le pagine in una cartella.</span><span class="sxs-lookup"><span data-stu-id="e384e-108">How to run code that lets you set values for all pages in a folder.</span></span>
> - <span data-ttu-id="e384e-109">Come eseguire codice prima e dopo una pagina viene caricata.</span><span class="sxs-lookup"><span data-stu-id="e384e-109">How to run code before and after a page loads.</span></span>
> - <span data-ttu-id="e384e-110">Come inviare errori a una pagina di errore centrale.</span><span class="sxs-lookup"><span data-stu-id="e384e-110">How to send errors to a central error page.</span></span>
> - <span data-ttu-id="e384e-111">Come aggiungere l'autenticazione a tutte le pagine in una cartella.</span><span class="sxs-lookup"><span data-stu-id="e384e-111">How to add authentication to all pages in a folder.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="e384e-112">Versioni del software utilizzate nell'esercitazione</span><span class="sxs-lookup"><span data-stu-id="e384e-112">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="e384e-113">Pagine Web ASP.NET (Razor) 2</span><span class="sxs-lookup"><span data-stu-id="e384e-113">ASP.NET Web Pages (Razor) 2</span></span>
> - <span data-ttu-id="e384e-114">WebMatrix 3</span><span class="sxs-lookup"><span data-stu-id="e384e-114">WebMatrix 3</span></span>
> - <span data-ttu-id="e384e-115">ASP.NET Web Helpers Library (pacchetto NuGet)</span><span class="sxs-lookup"><span data-stu-id="e384e-115">ASP.NET Web Helpers Library (NuGet package)</span></span>
>   
> 
> <span data-ttu-id="e384e-116">In questa esercitazione si integra inoltre con ASP.NET Web Pages 3 e Visual Studio 2013 o Visual Studio Express 2013 per Web, è possibile utilizzare ASP.NET Web Helpers Library.</span><span class="sxs-lookup"><span data-stu-id="e384e-116">This tutorial also works with ASP.NET Web Pages 3 and Visual Studio 2013 (or Visual Studio Express 2013 for Web), except you cannot use the ASP.NET Web Helpers Library.</span></span>


<a id="Adding_Website_Startup_Code"></a>
## <a name="adding-website-startup-code-for-aspnet-web-pages"></a><span data-ttu-id="e384e-117">Aggiungere il codice di avvio del sito Web per ASP.NET Web Pages</span><span class="sxs-lookup"><span data-stu-id="e384e-117">Adding Website Startup Code for ASP.NET Web Pages</span></span>

<span data-ttu-id="e384e-118">Per la maggior parte del codice scritto in ASP.NET Web Pages, una singola pagina può contenere tutto il codice che ha richiesto per la pagina.</span><span class="sxs-lookup"><span data-stu-id="e384e-118">For much of the code that you write in ASP.NET Web Pages, an individual page can contain all the code that's required for that page.</span></span> <span data-ttu-id="e384e-119">Ad esempio, se una pagina invia un messaggio di posta elettronica, è possibile inserire tutto il codice per l'operazione in una singola pagina.</span><span class="sxs-lookup"><span data-stu-id="e384e-119">For example, if a page sends an email message, it's possible to put all the code for that operation in a single page.</span></span> <span data-ttu-id="e384e-120">Ciò può includere il codice per inizializzare le impostazioni per l'invio di posta elettronica (ovvero, per il server SMTP) e per l'invio del messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="e384e-120">This can include the code to initialize the settings for sending email (that is, for the SMTP server) and for sending the email message.</span></span>

<span data-ttu-id="e384e-121">In alcuni casi, è comunque eseguire il codice prima dell'esecuzione di qualsiasi pagina del sito.</span><span class="sxs-lookup"><span data-stu-id="e384e-121">However, in some situations, you might want to run some code before any page on the site runs.</span></span> <span data-ttu-id="e384e-122">Ciò è utile per l'impostazione di valori che possono essere utilizzati ovunque nel sito (detto *valori globali*.) Ad esempio, alcuni helper necessario fornire i valori come impostazioni di posta elettronica o le chiavi dell'account.</span><span class="sxs-lookup"><span data-stu-id="e384e-122">This is useful for setting values that can be used anywhere in the site (referred to as *global values*.) For example, some helpers require you to provide values like email settings or account keys.</span></span> <span data-ttu-id="e384e-123">Può essere utile per mantenere queste impostazioni in valori globali.</span><span class="sxs-lookup"><span data-stu-id="e384e-123">It can be handy to keep these settings in global values.</span></span>

<span data-ttu-id="e384e-124">È possibile farlo creando una pagina denominata  *\_AppStart.cshtml* nella radice del sito.</span><span class="sxs-lookup"><span data-stu-id="e384e-124">You can do this by creating a page named *\_AppStart.cshtml* in the root of the site.</span></span> <span data-ttu-id="e384e-125">Se questa pagina è presente, viene eseguita la prima volta, verrà richiesta una pagina nel sito.</span><span class="sxs-lookup"><span data-stu-id="e384e-125">If this page exists, it runs the first time any page in the site is requested.</span></span> <span data-ttu-id="e384e-126">Pertanto, è un ottimo strumento per eseguire il codice per impostare i valori globali.</span><span class="sxs-lookup"><span data-stu-id="e384e-126">Therefore, it's a good place to run code to set global values.</span></span> <span data-ttu-id="e384e-127">(Poiché  *\_AppStart.cshtml* è un prefisso di un carattere di sottolineatura, non inviare la pagina ASP.NET in un browser anche se gli utenti richiedono direttamente.)</span><span class="sxs-lookup"><span data-stu-id="e384e-127">(Because *\_AppStart.cshtml* has an underscore prefix, ASP.NET won't send the page to a browser even if users request it directly.)</span></span>

<span data-ttu-id="e384e-128">Il diagramma seguente mostra come  *\_AppStart.cshtml* pagina funziona.</span><span class="sxs-lookup"><span data-stu-id="e384e-128">The following diagram shows how the *\_AppStart.cshtml* page works.</span></span> <span data-ttu-id="e384e-129">Quando arriva una richiesta per una pagina e se si tratta la prima richiesta per una pagina nel sito ASP.NET controlla innanzitutto se un  *\_AppStart.cshtml* esistente.</span><span class="sxs-lookup"><span data-stu-id="e384e-129">When a request comes in for a page, and if this is the first request for any page in the site, ASP.NET first checks whether a *\_AppStart.cshtml* page exists.</span></span> <span data-ttu-id="e384e-130">In questo caso, qualsiasi codice nel  *\_AppStart.cshtml* pagina viene eseguito e quindi di eseguire la pagina richiesta.</span><span class="sxs-lookup"><span data-stu-id="e384e-130">If so, any code in the *\_AppStart.cshtml* page runs, and then the requested page runs.</span></span>

![[immagine]](18-customizing-site-wide-behavior/_static/image1.jpg)

## <a name="setting-global-values-for-your-website"></a><span data-ttu-id="e384e-132">Impostazione dei valori globali per il sito Web</span><span class="sxs-lookup"><span data-stu-id="e384e-132">Setting Global Values for Your Website</span></span>

1. <span data-ttu-id="e384e-133">Nella cartella radice di un sito Web di WebMatrix, creare un file denominato  *\_AppStart.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e384e-133">In the root folder of a WebMatrix website, create a file named *\_AppStart.cshtml*.</span></span> <span data-ttu-id="e384e-134">Il file deve essere nella radice del sito.</span><span class="sxs-lookup"><span data-stu-id="e384e-134">The file must be in the root of the site.</span></span>
2. <span data-ttu-id="e384e-135">Sostituire il contenuto esistente con il seguente:</span><span class="sxs-lookup"><span data-stu-id="e384e-135">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample1.cshtml)]

    <span data-ttu-id="e384e-136">Questo codice è archiviato un valore nel `AppState` dizionario, che è automaticamente disponibile per tutte le pagine nel sito.</span><span class="sxs-lookup"><span data-stu-id="e384e-136">This code stores a value in the `AppState` dictionary, which is automatically available to all pages in the site.</span></span> <span data-ttu-id="e384e-137">Si noti che il  *\_AppStart.cshtml* file non dispone di qualsiasi tipo di markup in essa contenuti.</span><span class="sxs-lookup"><span data-stu-id="e384e-137">Notice that the *\_AppStart.cshtml* file does not have any markup in it.</span></span> <span data-ttu-id="e384e-138">La pagina verrà eseguito il codice e quindi reindirizzare alla pagina richiesta originariamente.</span><span class="sxs-lookup"><span data-stu-id="e384e-138">The page will run the code and then redirect to the page that was originally requested.</span></span>

    > [!NOTE]
    > <span data-ttu-id="e384e-139">Prestare attenzione quando il codice inserito nel  *\_AppStart.cshtml* file.</span><span class="sxs-lookup"><span data-stu-id="e384e-139">Be careful when you put code in the *\_AppStart.cshtml* file.</span></span> <span data-ttu-id="e384e-140">Se si verificano errori nel codice il  *\_AppStart.cshtml* file, non è possibile avviare il sito Web.</span><span class="sxs-lookup"><span data-stu-id="e384e-140">If any errors occur in code in the *\_AppStart.cshtml* file, the website won't start.</span></span>
3. <span data-ttu-id="e384e-141">Nella cartella radice, creare una nuova pagina denominata *AppName.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e384e-141">In the root folder, create a new page named *AppName.cshtml*.</span></span>
4. <span data-ttu-id="e384e-142">Sostituire il markup predefinito e il codice con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-142">Replace the default markup and code with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample2.html)]

    <span data-ttu-id="e384e-143">Questo codice estrae il valore di `AppState` oggetto che viene impostato nel  *\_AppStart.cshtml* pagina.</span><span class="sxs-lookup"><span data-stu-id="e384e-143">This code extracts the value from the `AppState` object that you set in the *\_AppStart.cshtml* page.</span></span>
5. <span data-ttu-id="e384e-144">Eseguire il *AppName.cshtml* pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="e384e-144">Run the *AppName.cshtml* page in a browser.</span></span> <span data-ttu-id="e384e-145">(Assicurarsi che la pagina è selezionata nel **file** dell'area di lavoro prima di eseguirlo.) La pagina Visualizza il valore globale.</span><span class="sxs-lookup"><span data-stu-id="e384e-145">(Make sure the page is selected in the **Files** workspace before you run it.) The page displays the global value.</span></span> 

    ![[immagine]](18-customizing-site-wide-behavior/_static/image2.jpg)

<a id="Setting_Values_For_Helpers"></a>
## <a name="setting-values-for-helpers"></a><span data-ttu-id="e384e-147">Impostazione dei valori per gli helper</span><span class="sxs-lookup"><span data-stu-id="e384e-147">Setting Values for Helpers</span></span>

<span data-ttu-id="e384e-148">Per un utilizzo ottimo di  *\_AppStart.cshtml* file consiste nell'impostare i valori per gli helper che si utilizzano nel sito e che devono essere inizializzati.</span><span class="sxs-lookup"><span data-stu-id="e384e-148">A good use for the *\_AppStart.cshtml* file is to set values for helpers that you use in your site and that have to be initialized.</span></span> <span data-ttu-id="e384e-149">Gli esempi tipici sono le impostazioni di posta elettronica per il `WebMail` helper e le chiavi pubbliche e private per il `ReCaptcha` helper.</span><span class="sxs-lookup"><span data-stu-id="e384e-149">Typical examples are email settings for the `WebMail` helper and the private and public keys for the `ReCaptcha` helper.</span></span> <span data-ttu-id="e384e-150">In questi casi è possibile impostare i valori di una volta il  *\_AppStart.cshtml* e quindi si è già impostate per tutte le pagine del sito.</span><span class="sxs-lookup"><span data-stu-id="e384e-150">In cases like these, you can set the values once in the *\_AppStart.cshtml* and then they're already set for all the pages in your site.</span></span>

<span data-ttu-id="e384e-151">Questa procedura viene illustrato come impostare `WebMail` impostazioni a livello globale.</span><span class="sxs-lookup"><span data-stu-id="e384e-151">This procedure shows you how to set `WebMail` settings globally.</span></span> <span data-ttu-id="e384e-152">(Per ulteriori informazioni sull'utilizzo di `WebMail` supporto, vedere [aggiunta di posta elettronica a un sito di pagine Web ASP.NET](../getting-started/11-adding-email-to-your-web-site.md).)</span><span class="sxs-lookup"><span data-stu-id="e384e-152">(For more information about using the `WebMail` helper, see [Adding Email to an ASP.NET Web Pages Site](../getting-started/11-adding-email-to-your-web-site.md).)</span></span>

1. <span data-ttu-id="e384e-153">Aggiungere il sito Web ASP.NET Web Helpers Library come descritto in [helper per l'installazione in un sito di pagine Web ASP.NET](https://go.microsoft.com/fwlink/?LinkId=252372), se non si già aggiunti.</span><span class="sxs-lookup"><span data-stu-id="e384e-153">Add the ASP.NET Web Helpers Library to your website as described in [Installing Helpers in an ASP.NET Web Pages Site](https://go.microsoft.com/fwlink/?LinkId=252372), if you haven't already added it.</span></span>
2. <span data-ttu-id="e384e-154">Se dispone già di un  *\_AppStart.cshtml* file, nella cartella radice di un sito Web, creare un file denominato  *\_AppStart.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e384e-154">If you don't already have a *\_AppStart.cshtml* file, in the root folder of a website create a file named *\_AppStart.cshtml*.</span></span>
3. <span data-ttu-id="e384e-155">Aggiungere il seguente `WebMail` le impostazioni per il  *\_AppStart.cshtml* file:</span><span class="sxs-lookup"><span data-stu-id="e384e-155">Add the following `WebMail` settings to the *\_AppStart.cshtml* file:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample3.cshtml?highlight=2-7)]

    <span data-ttu-id="e384e-156">Modificare le impostazioni correlate nel codice di posta elettronica seguenti:</span><span class="sxs-lookup"><span data-stu-id="e384e-156">Modify the following email related settings in the code:</span></span>

    - <span data-ttu-id="e384e-157">Impostare `your-SMTP-host` sul nome del server SMTP che è possibile accedere.</span><span class="sxs-lookup"><span data-stu-id="e384e-157">Set `your-SMTP-host` to the name of the SMTP server that you have access to.</span></span>
    - <span data-ttu-id="e384e-158">Impostare `your-user-name-here` per il nome utente per l'account del server SMTP.</span><span class="sxs-lookup"><span data-stu-id="e384e-158">Set `your-user-name-here` to the user name for your SMTP server account.</span></span>
    - <span data-ttu-id="e384e-159">Impostare `your-account-password` la password per l'account del server SMTP.</span><span class="sxs-lookup"><span data-stu-id="e384e-159">Set `your-account-password` to the password for your SMTP server account.</span></span>
    - <span data-ttu-id="e384e-160">Impostare `your-email-address-here` sul proprio indirizzo di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="e384e-160">Set `your-email-address-here` to your own email address.</span></span> <span data-ttu-id="e384e-161">Si tratta dell'indirizzo di posta elettronica da cui viene inviato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e384e-161">This is the email address that the message is sent from.</span></span> <span data-ttu-id="e384e-162">(Alcuni provider di posta elettronica non consentono di specificare un altro `From` indirizzi e utilizzerà il nome utente come il `From` indirizzo.)</span><span class="sxs-lookup"><span data-stu-id="e384e-162">(Some email providers don't let you specify a different `From` address and will use your user name as the `From` address.)</span></span>

    <span data-ttu-id="e384e-163">Per ulteriori informazioni sulle impostazioni SMTP, vedere [configurazione delle impostazioni di posta elettronica](https://go.microsoft.com/fwlink/?LinkID=202899#configuring_email_settings) nell'articolo [l'invio di posta elettronica da un sito di pagine Web ASP.NET (Razor)](https://go.microsoft.com/fwlink/?LinkID=202899) e [problemi con l'invio di posta elettronica](https://go.microsoft.com/fwlink/?LinkId=253001#email)nel [pagine Web ASP.NET (Razor) Troubleshooting Guide](https://go.microsoft.com/fwlink/?LinkId=253001).</span><span class="sxs-lookup"><span data-stu-id="e384e-163">For more information about SMTP settings, see [Configuring Email Settings](https://go.microsoft.com/fwlink/?LinkID=202899#configuring_email_settings) in the article [Sending Email from an ASP.NET Web Pages (Razor) Site](https://go.microsoft.com/fwlink/?LinkID=202899) and [Issues with Sending Email](https://go.microsoft.com/fwlink/?LinkId=253001#email) in the [ASP.NET Web Pages (Razor) Troubleshooting Guide](https://go.microsoft.com/fwlink/?LinkId=253001).</span></span>
- <span data-ttu-id="e384e-164">Salvare il  *\_AppStart.cshtml* file e chiuderlo.</span><span class="sxs-lookup"><span data-stu-id="e384e-164">Save the *\_AppStart.cshtml* file and close it.</span></span>
- <span data-ttu-id="e384e-165">Nella cartella radice di un sito Web, creare nuova pagina denominata *TestEmail.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e384e-165">In the root folder of a website, create new page named *TestEmail.cshtml*.</span></span>
- <span data-ttu-id="e384e-166">Sostituire il contenuto esistente con il seguente:</span><span class="sxs-lookup"><span data-stu-id="e384e-166">Replace the existing content with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample4.cshtml)]
- <span data-ttu-id="e384e-167">Eseguire il *TestEmail.cshtml* pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="e384e-167">Run the *TestEmail.cshtml* page in a browser.</span></span>
- <span data-ttu-id="e384e-168">Compilare i campi per inviare un messaggio di posta elettronica e quindi fare clic su **inviare**.</span><span class="sxs-lookup"><span data-stu-id="e384e-168">Fill in the fields to send yourself an email message and then click **Send**.</span></span>
- <span data-ttu-id="e384e-169">Controllare la posta elettronica per verificare che è stato utilizzato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e384e-169">Check your email to make sure you've gotten the message.</span></span>

<span data-ttu-id="e384e-170">La parte importante di questo esempio è che le impostazioni che in genere non cambiano, ad esempio il nome del server SMTP e le credenziali di posta elettronica, vengono impostate  *\_AppStart.cshtml* file.</span><span class="sxs-lookup"><span data-stu-id="e384e-170">The important part of this example is that the settings that you don't usually change — like the name of your SMTP server and your email credentials — are set in the *\_AppStart.cshtml* file.</span></span> <span data-ttu-id="e384e-171">In questo modo non è necessario impostarle nuovamente in ogni pagina in cui si invia tramite posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="e384e-171">That way you don't need to set them again in each page where you send email.</span></span> <span data-ttu-id="e384e-172">(Anche se se per qualche motivo, è necessario modificare tali impostazioni, è possibile impostarle singolarmente in una pagina.) Nella pagina, è solo necessario impostare i valori che in genere modificato ogni volta, ad esempio il destinatario e il corpo del messaggio di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="e384e-172">(Although if for some reason you need to change those settings, you can set them individually in a page.) In the page, you only set the values that typically change each time, like the recipient and the body of the email message.</span></span>

<a id="Running_Code_Before_and_After"></a>
## <a name="running-code-before-and-after-files-in-a-folder"></a><span data-ttu-id="e384e-173">Esecuzione del codice prima e dopo i file in una cartella</span><span class="sxs-lookup"><span data-stu-id="e384e-173">Running Code Before and After Files in a Folder</span></span>

<span data-ttu-id="e384e-174">Come è possibile utilizzare  *\_AppStart.cshtml* per scrivere il codice prima di eseguire le pagine del sito, è possibile scrivere codice che viene eseguito prima (e, dopo aver) qualsiasi pagina in una cartella particolare di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="e384e-174">Just like you can use *\_AppStart.cshtml* to write code before pages in the site run, you can write code that runs before (and after) any page in a particular folder run.</span></span> <span data-ttu-id="e384e-175">Ciò è utile per operazioni come l'impostazione stessa pagina di layout per tutte le pagine in una cartella o a un controllo che un utente è connesso prima di eseguire una pagina nella cartella.</span><span class="sxs-lookup"><span data-stu-id="e384e-175">This is useful for things like setting the same layout page for all the pages in a folder, or for checking that a user is logged in before running a page in the folder.</span></span>

<span data-ttu-id="e384e-176">Per le pagine in particolare le cartelle, è possibile creare codice in un file denominato  *\_Pagestart*.</span><span class="sxs-lookup"><span data-stu-id="e384e-176">For pages in particular folders, you can create code in a file named *\_PageStart.cshtml*.</span></span> <span data-ttu-id="e384e-177">Il diagramma seguente mostra come  *\_Pagestart* pagina funziona.</span><span class="sxs-lookup"><span data-stu-id="e384e-177">The following diagram shows how the *\_PageStart.cshtml* page works.</span></span> <span data-ttu-id="e384e-178">Quando arriva una richiesta per una pagina, ASP.NET esegue la ricerca di un  *\_AppStart.cshtml* pagina e viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="e384e-178">When a request comes in for a page, ASP.NET first checks for a *\_AppStart.cshtml* page and runs that.</span></span> <span data-ttu-id="e384e-179">ASP.NET controlla se è presente un  *\_Pagestart* pagina e in tal caso, viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="e384e-179">Then ASP.NET checks whether there's a *\_PageStart.cshtml* page, and if so, runs that.</span></span> <span data-ttu-id="e384e-180">Viene quindi eseguita la pagina richiesta.</span><span class="sxs-lookup"><span data-stu-id="e384e-180">It then runs the requested page.</span></span>

<span data-ttu-id="e384e-181">All'interno di  *\_Pagestart* pagina, è possibile specificare dove durante l'elaborazione che si desidera che la pagina richiesta per eseguire includendo un `RunPage` metodo.</span><span class="sxs-lookup"><span data-stu-id="e384e-181">Inside the *\_PageStart.cshtml* page, you can specify where during processing you want the requested page to run by including a `RunPage` method.</span></span> <span data-ttu-id="e384e-182">Ciò consente di eseguire codice prima che venga eseguita la pagina richiesta e quindi nuovamente dopo di esso.</span><span class="sxs-lookup"><span data-stu-id="e384e-182">This lets you run code before the requested page runs and then again after it.</span></span> <span data-ttu-id="e384e-183">Se non si include `RunPage`, tutto il codice in  *\_Pagestart* viene eseguito, quindi selezionare la pagina richiesta viene eseguita automaticamente.</span><span class="sxs-lookup"><span data-stu-id="e384e-183">If you don't include `RunPage`, all the code in *\_PageStart.cshtml* runs, and then the requested page runs automatically.</span></span>

![[immagine]](18-customizing-site-wide-behavior/_static/image3.jpg)

<span data-ttu-id="e384e-185">ASP.NET consente di creare una gerarchia di  *\_Pagestart* file.</span><span class="sxs-lookup"><span data-stu-id="e384e-185">ASP.NET lets you create a hierarchy of *\_PageStart.cshtml* files.</span></span> <span data-ttu-id="e384e-186">È possibile inserire un  *\_Pagestart* file nella radice del sito e in qualsiasi sottocartella.</span><span class="sxs-lookup"><span data-stu-id="e384e-186">You can put a *\_PageStart.cshtml* file in the root of the site and in any subfolder.</span></span> <span data-ttu-id="e384e-187">Quando viene richiesta una pagina, il  *\_Pagestart* l'esecuzione del livello più alto (più vicino alla radice del sito), seguito dal file di  *\_Pagestart* file nella prossima sottocartella, e così via lungo la struttura sottocartella fino a quando la richiesta raggiunge la cartella che contiene la pagina richiesta.</span><span class="sxs-lookup"><span data-stu-id="e384e-187">When a page is requested, the *\_PageStart.cshtml* file at the top-most level (nearest to the site root) runs, followed by the *\_PageStart.cshtml* file in the next subfolder, and so on down the subfolder structure until the request reaches the folder that contains the requested page.</span></span> <span data-ttu-id="e384e-188">Dopo aver tutti l'applicabili  *\_Pagestart* file è sono eseguito, verrà eseguita la pagina richiesta.</span><span class="sxs-lookup"><span data-stu-id="e384e-188">After all the applicable *\_PageStart.cshtml* files have run, the requested page runs.</span></span>

<span data-ttu-id="e384e-189">Ad esempio, potrebbe essere la seguente combinazione di  *\_Pagestart* file e *cshtml* file:</span><span class="sxs-lookup"><span data-stu-id="e384e-189">For example, you might have the following combination of *\_PageStart.cshtml* files and *Default.cshtml* file:</span></span>

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample5.cshtml)]

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample6.cshtml)]

[!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample7.cshtml)]

<span data-ttu-id="e384e-190">Quando si esegue */myfolder/default.cshtml*, si noterà quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-190">When you run */myfolder/default.cshtml*, you'll see the following:</span></span>

[!code-console[Main](18-customizing-site-wide-behavior/samples/sample8.cmd)]

## <a name="running-initialization-code-for-all-pages-in-a-folder"></a><span data-ttu-id="e384e-191">Esecuzione del codice di inizializzazione per tutte le pagine in una cartella</span><span class="sxs-lookup"><span data-stu-id="e384e-191">Running Initialization Code for All Pages in a Folder</span></span>

<span data-ttu-id="e384e-192">Per un utilizzo ottimo  *\_Pagestart* file consiste nell'inizializzare la stessa pagina di layout per tutti i file in un'unica cartella.</span><span class="sxs-lookup"><span data-stu-id="e384e-192">A good use for *\_PageStart.cshtml* files is to initialize the same layout page for all files in a single folder.</span></span>

1. <span data-ttu-id="e384e-193">Nella cartella radice, creare una nuova cartella denominata *InitPages*.</span><span class="sxs-lookup"><span data-stu-id="e384e-193">In the root folder, create a new folder named *InitPages*.</span></span>
2. <span data-ttu-id="e384e-194">Nel *InitPages* cartella del sito Web, creare un file denominato  *\_Pagestart* e sostituire il markup predefinito e il codice con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-194">In the *InitPages* folder of your website, create a file named *\_PageStart.cshtml* and replace the default markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample9.cshtml)]
3. <span data-ttu-id="e384e-195">Nella radice del sito Web, creare una cartella denominata *Shared*.</span><span class="sxs-lookup"><span data-stu-id="e384e-195">In the root of the website, create a folder named *Shared*.</span></span>
4. <span data-ttu-id="e384e-196">Nel *Shared* cartella, creare un file denominato  *\_Layout1.cshtml* e sostituire il markup predefinito e il codice con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-196">In the *Shared* folder, create a file named *\_Layout1.cshtml* and replace the default markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample10.cshtml)]
5. <span data-ttu-id="e384e-197">Nel *InitPages* cartella, creare un file denominato *Content1.cshtml* e sostituire il contenuto esistente con il seguente:</span><span class="sxs-lookup"><span data-stu-id="e384e-197">In the *InitPages* folder, create a file named *Content1.cshtml* and replace the existing content with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample11.html)]
6. <span data-ttu-id="e384e-198">Nel *InitPages* cartella, un file denominato *Content2.cshtml* e sostituire il markup predefinito con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-198">In the *InitPages* folder, create another file named *Content2.cshtml* and replace the default markup with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample12.html)]
7. <span data-ttu-id="e384e-199">Eseguire *Content1.cshtml* in un browser.</span><span class="sxs-lookup"><span data-stu-id="e384e-199">Run *Content1.cshtml* in a browser.</span></span> 

    ![[immagine]](18-customizing-site-wide-behavior/_static/image4.jpg)

    <span data-ttu-id="e384e-201">Quando il *Content1.cshtml* pagina viene eseguito, il  *\_Pagestart* file imposta `Layout` e imposta inoltre `PageData["MyBackground"]` su un colore.</span><span class="sxs-lookup"><span data-stu-id="e384e-201">When the *Content1.cshtml* page runs, the *\_PageStart.cshtml* file sets `Layout` and also sets `PageData["MyBackground"]` to a color.</span></span> <span data-ttu-id="e384e-202">In *Content1.cshtml*, vengono applicati il layout e il colore.</span><span class="sxs-lookup"><span data-stu-id="e384e-202">In *Content1.cshtml*, the layout and color are applied.</span></span>
8. <span data-ttu-id="e384e-203">Visualizzazione *Content2.cshtml* in un browser.</span><span class="sxs-lookup"><span data-stu-id="e384e-203">Display *Content2.cshtml* in a browser.</span></span> 

    <span data-ttu-id="e384e-204">Il layout è lo stesso, poiché entrambe le pagine utilizzano la stessa pagina layout e colori come inizializzare in  *\_Pagestart*.</span><span class="sxs-lookup"><span data-stu-id="e384e-204">The layout is the same, because both pages use the same layout page and color as initialized in *\_PageStart.cshtml*.</span></span>

## <a name="using-pagestartcshtml-to-handle-errors"></a><span data-ttu-id="e384e-205">Utilizzando \_Pagestart per gestire gli errori</span><span class="sxs-lookup"><span data-stu-id="e384e-205">Using \_PageStart.cshtml to Handle Errors</span></span>

<span data-ttu-id="e384e-206">Utilizzare un'altra utile per il  *\_Pagestart* file consiste nel creare un modo per gestire gli errori di programmazione (eccezioni) che potrebbero verificarsi in qualsiasi *. cshtml* pagina in una cartella.</span><span class="sxs-lookup"><span data-stu-id="e384e-206">Another good use for the *\_PageStart.cshtml* file is to create a way to handle programming errors (exceptions) that might occur in any *.cshtml* page in a folder.</span></span> <span data-ttu-id="e384e-207">In questo esempio viene illustrato un modo per eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="e384e-207">This example shows you one way to do this.</span></span>

1. <span data-ttu-id="e384e-208">Nella cartella radice, creare una cartella denominata *InitCatch*.</span><span class="sxs-lookup"><span data-stu-id="e384e-208">In the root folder, create a folder named *InitCatch*.</span></span>
2. <span data-ttu-id="e384e-209">Nel *InitCatch* cartella del sito Web, creare un file denominato  *\_Pagestart* e sostituire il codice esistente e il codice con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-209">In the *InitCatch* folder of your website, create a file named *\_PageStart.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample13.cshtml)]

    <span data-ttu-id="e384e-210">In questo codice, si tenta di eseguire la pagina richiesta in modo esplicito chiamando il `RunPage` metodo all'interno di un `try` blocco.</span><span class="sxs-lookup"><span data-stu-id="e384e-210">In this code, you try running the requested page explicitly by calling the `RunPage` method inside a `try` block.</span></span> <span data-ttu-id="e384e-211">In caso di errori di programmazione nella richiesta di pagina, il codice all'interno di `catch` blocco viene eseguito.</span><span class="sxs-lookup"><span data-stu-id="e384e-211">If any programming errors occur in the requested page, the code inside the `catch` block runs.</span></span> <span data-ttu-id="e384e-212">In questo caso, il codice reindirizza a una pagina (*Error.cshtml*) e passa il nome del file che si è verificato l'errore come parte dell'URL.</span><span class="sxs-lookup"><span data-stu-id="e384e-212">In this case, the code redirects to a page (*Error.cshtml*) and passes the name of the file that experienced the error as part of the URL.</span></span> <span data-ttu-id="e384e-213">(Creerai la pagina al più presto.)</span><span class="sxs-lookup"><span data-stu-id="e384e-213">(You'll create the page shortly.)</span></span>
3. <span data-ttu-id="e384e-214">Nel *InitCatch* cartella del sito Web, creare un file denominato *Exception.cshtml* e sostituire il codice esistente e il codice con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-214">In the *InitCatch* folder of your website, create a file named *Exception.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample14.cshtml)]

    <span data-ttu-id="e384e-215">Ai fini di questo esempio, alle operazioni eseguite in questa pagina è deliberatamente la creazione di un errore durante il tentativo di aprire un file di database che non esiste.</span><span class="sxs-lookup"><span data-stu-id="e384e-215">For purposes of this example, what you're doing in this page is deliberately creating an error by trying to open a database file that doesn't exist.</span></span>
4. <span data-ttu-id="e384e-216">Nella cartella radice, creare un file denominato *Error.cshtml* e sostituire il codice esistente e il codice con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-216">In the root folder, create a file named *Error.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-html[Main](18-customizing-site-wide-behavior/samples/sample15.html)]

    <span data-ttu-id="e384e-217">In questa pagina, l'espressione `@Request["source"]` Ottiene il valore non compreso nell'URL e lo visualizza.</span><span class="sxs-lookup"><span data-stu-id="e384e-217">In this page, the expression `@Request["source"]` gets the value out of the URL and displays it.</span></span>
5. <span data-ttu-id="e384e-218">Nella barra degli strumenti, fare clic su **salvare**.</span><span class="sxs-lookup"><span data-stu-id="e384e-218">In the toolbar, click **Save**.</span></span>
6. <span data-ttu-id="e384e-219">Eseguire *Exception.cshtml* in un browser.</span><span class="sxs-lookup"><span data-stu-id="e384e-219">Run *Exception.cshtml* in a browser.</span></span> 

    ![[immagine]](18-customizing-site-wide-behavior/_static/image5.jpg)

    <span data-ttu-id="e384e-221">Perché si verifica un errore *Exception.cshtml*,  *\_Pagestart* reindirizza a pagina di *Error.cshtml* file, che viene visualizzato il messaggio.</span><span class="sxs-lookup"><span data-stu-id="e384e-221">Because an error occurs in *Exception.cshtml*, the *\_PageStart.cshtml* page redirects to the *Error.cshtml* file, which displays the message.</span></span>

    <span data-ttu-id="e384e-222">Per ulteriori informazioni sulle eccezioni, vedere [Introduzione a ASP.NET Web Pages di programmazione utilizzando la sintassi Razor](https://go.microsoft.com/fwlink/?LinkID=251587).</span><span class="sxs-lookup"><span data-stu-id="e384e-222">For more information about exceptions, see [Introduction to ASP.NET Web Pages Programming Using the Razor Syntax](https://go.microsoft.com/fwlink/?LinkID=251587).</span></span>

<a id="Using__PageStart.cshtml_to_Restrict_Folder_Access"></a>
## <a name="using-pagestartcshtml-to-restrict-folder-access"></a><span data-ttu-id="e384e-223">Utilizzando \_Pagestart per limitare l'accesso alla cartella</span><span class="sxs-lookup"><span data-stu-id="e384e-223">Using \_PageStart.cshtml to Restrict Folder Access</span></span>

<span data-ttu-id="e384e-224">È inoltre possibile utilizzare il  *\_Pagestart* file per limitare l'accesso a tutti i file in una cartella.</span><span class="sxs-lookup"><span data-stu-id="e384e-224">You can also use the *\_PageStart.cshtml* file to restrict access to all the files in a folder.</span></span>

1. <span data-ttu-id="e384e-225">In WebMatrix, creare un nuovo sito Web utilizzando il **del sito da un modello** opzione.</span><span class="sxs-lookup"><span data-stu-id="e384e-225">In WebMatrix, create a new website using the **Site From Template** option.</span></span>
2. <span data-ttu-id="e384e-226">I modelli disponibili, selezionare **Starter Site**.</span><span class="sxs-lookup"><span data-stu-id="e384e-226">From the available templates, select **Starter Site**.</span></span>
3. <span data-ttu-id="e384e-227">Nella cartella radice, creare una cartella denominata *AuthenticatedContent*.</span><span class="sxs-lookup"><span data-stu-id="e384e-227">In the root folder, create a folder named *AuthenticatedContent*.</span></span>
4. <span data-ttu-id="e384e-228">Nel *AuthenticatedContent* cartella, creare un file denominato  *\_Pagestart* e sostituire il codice esistente e il codice con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-228">In the *AuthenticatedContent* folder, create a file named *\_PageStart.cshtml* and replace the existing markup and code with the following:</span></span> 

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample16.cshtml)]

    <span data-ttu-id="e384e-229">Il codice avvia, impedendo che tutti i file nella cartella memorizzata nella cache.</span><span class="sxs-lookup"><span data-stu-id="e384e-229">The code starts by preventing all files in the folder from being cached.</span></span> <span data-ttu-id="e384e-230">(Questo è necessario per scenari come i computer pubblici, in cui si desidera pagine memorizzate nella cache di un utente sia disponibile per l'utente successivo). Successivamente, il codice determina se l'utente ha effettuato l'accesso al sito prima di visualizzare le pagine nella cartella.</span><span class="sxs-lookup"><span data-stu-id="e384e-230">(This is required for scenarios like public computers, where you don't want one user's cached pages to be available to the next user.) Next, the code determines whether the user has signed in to the site before they can view any of the pages in the folder.</span></span> <span data-ttu-id="e384e-231">Se l'utente non è connesso, il codice reindirizza alla pagina di accesso.</span><span class="sxs-lookup"><span data-stu-id="e384e-231">If the user is not signed in, the code redirects to the login page.</span></span> <span data-ttu-id="e384e-232">Pagina di accesso può restituire l'utente alla pagina richiesta originariamente se si include un valore di stringa di query denominato `ReturnUrl`.</span><span class="sxs-lookup"><span data-stu-id="e384e-232">The login page can return the user to the page that was originally requested if you include a query string value named `ReturnUrl`.</span></span>
5. <span data-ttu-id="e384e-233">Creare una nuova pagina di *AuthenticatedContent* cartella denominata *Page.cshtml*.</span><span class="sxs-lookup"><span data-stu-id="e384e-233">Create a new page in the *AuthenticatedContent* folder named *Page.cshtml*.</span></span>
6. <span data-ttu-id="e384e-234">Sostituire il markup predefinito con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="e384e-234">Replace the default markup with the following:</span></span>  

    [!code-cshtml[Main](18-customizing-site-wide-behavior/samples/sample17.cshtml)]
7. <span data-ttu-id="e384e-235">Eseguire *Page.cshtml* in un browser.</span><span class="sxs-lookup"><span data-stu-id="e384e-235">Run *Page.cshtml* in a browser.</span></span> <span data-ttu-id="e384e-236">Il codice si viene reindirizzati a una pagina di accesso.</span><span class="sxs-lookup"><span data-stu-id="e384e-236">The code redirects you to a login page.</span></span> <span data-ttu-id="e384e-237">È necessario registrare prima di accedere.</span><span class="sxs-lookup"><span data-stu-id="e384e-237">You must register before logging in.</span></span> <span data-ttu-id="e384e-238">Dopo aver registrato e connesso, è possibile passare alla pagina e visualizzarne il contenuto.</span><span class="sxs-lookup"><span data-stu-id="e384e-238">After you've registered and logged in, you can navigate to the page and view its contents.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="e384e-239">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="e384e-239">Additional Resources</span></span>

[<span data-ttu-id="e384e-240">Introduzione a ASP.NET Web Pages con sintassi Razor di programmazione</span><span class="sxs-lookup"><span data-stu-id="e384e-240">Introduction to ASP.NET Web Pages Programming Using the Razor Syntax</span></span>](https://go.microsoft.com/fwlink/?LinkID=251587)
